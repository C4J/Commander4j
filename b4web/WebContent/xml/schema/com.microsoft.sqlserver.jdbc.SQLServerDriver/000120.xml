<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE DDL SYSTEM "schema.dtd">
<DDL>

<statement>
	ALTER TABLE [dbo].[APP_LABEL_DATA] ADD [LAYERS] INT
</statement>

<statement>
	ALTER TABLE [dbo].APP_LABEL_DATA ALTER COLUMN PRINT_COPIES INT NULL
</statement>

  <statement>                       
		ALTER VIEW [dbo].[view_auto_labeller_printer]
		AS
		SELECT        dbo.APP_AUTO_LABELLER.LINE, dbo.APP_AUTO_LABELLER.MODIFIED, dbo.APP_AUTO_LABELLER.UNIQUE_ID, dbo.APP_LABEL_DATA.LABEL_TYPE, 
		                         dbo.SYS_PRINTER_LINE_MEMBERSHIP.PRINTER_ID, dbo.SYS_PRINTERS.ENABLED, dbo.SYS_PRINTERS.PRINTER_TYPE, dbo.SYS_PRINTERS.IP_ADDRESS, 
		                         dbo.SYS_PRINTERS.PORT, dbo.SYS_PRINTERS.GROUP_ID, dbo.SYS_PRINTERS.LANGUAGE, dbo.SYS_PRINTERS.PRINTER_DPI, 
		                         dbo.APP_LABEL_DATA.PROCESS_ORDER, dbo.APP_LABEL_DATA.MATERIAL, dbo.APP_LABEL_DATA.MATERIAL_TYPE, 
		                         dbo.APP_MATERIAL.DESCRIPTION AS MATERIAL_DESCRIPTION, dbo.APP_MATERIAL.SHELF_LIFE_UOM, dbo.APP_MATERIAL.SHELF_LIFE, 
		                         dbo.APP_MATERIAL.SHELF_LIFE_RULE, dbo.APP_LABEL_DATA.BATCH_NUMBER, dbo.APP_LABEL_DATA.REQUIRED_RESOURCE,
		                             (SELECT        KEY_VALUE
		                               FROM            dbo.SYS_CONTROL
		                               WHERE        (SYSTEM_KEY = 'PLANT')) AS PLANT, dbo.APP_LABEL_DATA.LOCATION_ID, dbo.APP_LABEL_DATA.DATE_OF_MANUFACTURE, 
		                         dbo.APP_LABEL_DATA.EXPIRY_DATE, dbo.APP_LABEL_DATA.PROD_EAN, dbo.APP_LABEL_DATA.PROD_VARIANT, dbo.APP_LABEL_DATA.PROD_QUANTITY, 
		                         dbo.APP_LABEL_DATA.PROD_UOM, dbo.APP_LABEL_DATA.BASE_EAN, dbo.APP_LABEL_DATA.BASE_VARIANT, dbo.APP_LABEL_DATA.BASE_QUANTITY, 
		                         dbo.APP_LABEL_DATA.BASE_UOM, dbo.APP_LABEL_DATA.CUSTOMER_ID, dbo.APP_CUSTOMER.CUSTOMER_NAME, dbo.APP_LABEL_DATA.PRINT_COPIES, 
		                         dbo.APP_LABEL_DATA.MODULE_ID, dbo.APP_LABEL_DATA.OVERRIDE_MANUFACTURE_DATE, dbo.APP_LABEL_DATA.OVERRIDE_EXPIRY_DATE, 
		                         dbo.APP_LABEL_DATA.OVERRIDE_BATCH_PREFIX, dbo.APP_LABEL_DATA.BATCH_PREFIX, dbo.APP_LABEL_DATA.BATCH_SUFFIX, 
		                         dbo.SYS_MODULES.REPORT_TYPE, dbo.SYS_MODULES.MODULE_TYPE, dbo.SYS_MODULES.REPORT_FILENAME, 
		                         dbo.APP_MATERIAL_CUSTOMER_DATA.DATA AS PART_NO,dbo.APP_LABEL_DATA.LAYERS
		FROM            dbo.APP_AUTO_LABELLER INNER JOIN
		                         dbo.SYS_PRINTER_LINE_MEMBERSHIP ON dbo.APP_AUTO_LABELLER.LINE = dbo.SYS_PRINTER_LINE_MEMBERSHIP.LINE AND 
		                         dbo.APP_AUTO_LABELLER.GROUP_ID = dbo.SYS_PRINTER_LINE_MEMBERSHIP.GROUP_ID INNER JOIN
		                         dbo.SYS_PRINTERS ON dbo.SYS_PRINTER_LINE_MEMBERSHIP.PRINTER_ID = dbo.SYS_PRINTERS.PRINTER_ID AND 
		                         dbo.SYS_PRINTER_LINE_MEMBERSHIP.GROUP_ID = dbo.SYS_PRINTERS.GROUP_ID INNER JOIN
		                         dbo.APP_LABEL_DATA ON dbo.APP_LABEL_DATA.UNIQUE_ID = dbo.APP_AUTO_LABELLER.UNIQUE_ID INNER JOIN
		                         dbo.APP_MATERIAL ON dbo.APP_MATERIAL.MATERIAL = dbo.APP_LABEL_DATA.MATERIAL INNER JOIN
		                         dbo.APP_CUSTOMER ON dbo.APP_LABEL_DATA.CUSTOMER_ID = dbo.APP_CUSTOMER.CUSTOMER_ID INNER JOIN
		                         dbo.SYS_MODULES ON dbo.APP_LABEL_DATA.MODULE_ID = dbo.SYS_MODULES.MODULE_ID LEFT OUTER JOIN
		                         dbo.APP_MATERIAL_CUSTOMER_DATA ON dbo.APP_LABEL_DATA.MATERIAL = dbo.APP_MATERIAL_CUSTOMER_DATA.MATERIAL AND 
		                         dbo.APP_LABEL_DATA.CUSTOMER_ID = dbo.APP_MATERIAL_CUSTOMER_DATA.CUSTOMER_ID AND 
		                         dbo.APP_MATERIAL_CUSTOMER_DATA.DATA_ID = 'PART_NO'
		WHERE        (dbo.SYS_PRINTERS.ENABLED = 'Y')
</statement>
		
</DDL>
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE DDL SYSTEM "schema.dtd">
<DDL>

<statement>
	ALTER TABLE `APP_MHN` ADD COLUMN `WRITE_OFF_REF` VARCHAR(20)  DEFAULT '';
</statement>

<statement>
	ALTER TABLE `APP_QM_SAMPLE` ADD COLUMN `USER_DATA_3` VARCHAR(20)  DEFAULT '';
</statement>

<statement>
	ALTER TABLE `APP_QM_SAMPLE` ADD COLUMN `USER_DATA_4` VARCHAR(20)  DEFAULT '';
</statement>

<statement>
	UPDATE `APP_QM_SAMPLE` SET `USER_DATA_3` = '';
</statement>

<statement>
	UPDATE `APP_QM_SAMPLE` SET `USER_DATA_4` = '';
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Write_Off_Ref', 'EN', 'Write Off Ref', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Write_Off_Ref', 'NL', 'Write Off Ref', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Write_Off_Ref', 'HU', 'Write Off Ref', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Write_Off_Ref', 'IT', 'Write Off Ref', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Write_Off_Ref', 'DE', 'Write Off Ref', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Write_Off_Ref', 'ES', 'Write Off Ref', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Write_Off_Ref', 'PL', 'Write Off Ref', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data3', 'EN', 'Shift ID', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data3', 'NL', 'Shift ID', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data3', 'HU', 'Shift ID', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data3', 'IT', 'Shift ID', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data3', 'DE', 'Shift ID', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data3', 'ES', 'Shift ID', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data3', 'PL', 'Shift ID', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data4', 'EN', 'Product Group', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data4', 'NL', 'Product Group', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data4', 'HU', 'Product Group', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data4', 'IT', 'Product Group', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data4', 'DE', 'Product Group', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data4', 'ES', 'Product Group', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data4', 'PL', 'Product Group', 'Q')
</statement>

<statement>
CREATE OR REPLACE VIEW `view_qm_results` AS
    SELECT 
        `samp`.`PROCESS_ORDER` AS `PROCESS_ORDER`,
        `samp`.`MATERIAL` AS `MATERIAL`,
        `samp`.`SAMPLE_ID` AS `SAMPLE_ID`,
        `samp`.`SAMPLE_DATE` AS `SAMPLE_DATE`,
        `samp`.`USER_DATA_1` AS `USER_DATA_1`,
        `samp`.`USER_DATA_2` AS `USER_DATA_2`,
        `samp`.`USER_DATA_3` AS `USER_DATA_3`,
        `samp`.`USER_DATA_4` AS `USER_DATA_4`,
        `result`.`TEST_ID` AS `TEST_ID`,
        `dict`.`DESCRIPTION` AS `TEST_DESCRIPTION`,
        `result`.`VALUE` AS `VALUE`,
        COALESCE(`valist`.`DESCRIPTION`, `result`.`VALUE`) AS `RESULT`
    FROM
        (((`app_qm_sample` `samp`
        LEFT JOIN `app_qm_result` `result` ON ((`result`.`SAMPLE_ID` = `samp`.`SAMPLE_ID`)))
        LEFT JOIN `app_qm_dictionary` `dict` ON ((`dict`.`TEST_ID` = `result`.`TEST_ID`)))
        LEFT JOIN `app_qm_selectlist` `valist` ON (((`valist`.`SELECT_LIST_ID` = `dict`.`SELECT_LIST_ID`)
            AND (`valist`.`VALUE` = `result`.`VALUE`))));
</statement>


<statement>
	INSERT INTO APP_MATERIAL_DATA_IDS (DATA_ID,DESCRIPTION) VALUES ('CONTAINER_CODE', 'Container Code')
</statement>

<statement>
	INSERT INTO APP_MATERIAL_DATA_IDS (DATA_ID,DESCRIPTION) VALUES ('PRODUCT_GROUP', 'Product Group')
</statement>

<statement>
	INSERT INTO `SYS_USER_REPORTS` (`USER_REPORT_ID`,`DISPLAY_SEQUENCE`,`DESCRIPTION`,`SQL_SELECT`,`MODULE_ID`,`DESTINATION`,`ENABLED`,`PRIVATE`,`USER_ID`,`GROUP_ID`,`PARAM_DATE_RANGE`,`SAVE_PATH`,`PREVIEW`,`PROMPT_SAVE_AS`,`EMAIL_ENABLED`,`EMAIL_PROMPT_ENABLED`,`EMAIL_ADDRESSES`) 
	VALUES ('USER_DATA_1',0,'USER_DATA_1 (SAMPLE LABEL)','SELECT APP_MATERIAL_CUSTOMER_DATA.`DATA` \nFROM\nAPP_MATERIAL_CUSTOMER_DATA\nRIGHT JOIN APP_PROCESS_ORDER\nON APP_MATERIAL_CUSTOMER_DATA.MATERIAL = APP_PROCESS_ORDER.MATERIAL\nAND APP_MATERIAL_CUSTOMER_DATA.CUSTOMER_ID = APP_PROCESS_ORDER.CUSTOMER_ID\nWHERE\nPROCESS_ORDER = ?\nAND DATA_ID = \'CONTAINER_CODE\'','','SYSTEM','Y','N','DAVE','','N','','N','N','N','N','')
</statement>

<statement>
	CREATE OR REPLACE VIEW `view_qm_analysis_01` AS
	SELECT
	APP_PROCESS_ORDER_RESOURCE.BATCH_SUFFIX,
	APP_PROCESS_ORDER_RESOURCE.DESCRIPTION AS RESOURCE_DESCRIPTION,
	APP_QM_SAMPLE.SAMPLE_DATE,
	APP_QM_SAMPLE.SAMPLE_ID,
	APP_QM_SAMPLE.PROCESS_ORDER,
	APP_PROCESS_ORDER.REQUIRED_RESOURCE,
	APP_QM_SAMPLE.MATERIAL,
	APP_QM_SAMPLE.USER_DATA_1 AS USER_DATA_1,
	APP_QM_SAMPLE.USER_DATA_2 AS USER_DATA_2,
	APP_QM_SAMPLE.USER_DATA_3 AS USER_DATA_3,
	APP_QM_SAMPLE.USER_DATA_4 AS USER_DATA_4,
	APP_QM_SELECTLIST_PROD_PANEL.DESCRIPTION AS PRODUCT_PANEL,
	APP_QM_SELECTLIST_PACK_PANEL.DESCRIPTION AS PACK_PANEL,
	APP_QM_RESULT_PH.`VALUE` AS PH
	FROM
	APP_QM_SAMPLE
	JOIN APP_QM_RESULT AS APP_QM_RESULT_PROD_PANEL
	ON APP_QM_SAMPLE.SAMPLE_ID = APP_QM_RESULT_PROD_PANEL.SAMPLE_ID 
	JOIN APP_QM_DICTIONARY AS APP_QM_DICTIONARY_PROD_PANEL
	ON APP_QM_RESULT_PROD_PANEL.TEST_ID = APP_QM_DICTIONARY_PROD_PANEL.TEST_ID 
	JOIN APP_QM_SELECTLIST AS APP_QM_SELECTLIST_PROD_PANEL
	ON APP_QM_RESULT_PROD_PANEL.`VALUE` = APP_QM_SELECTLIST_PROD_PANEL.`VALUE`
	AND APP_QM_DICTIONARY_PROD_PANEL.SELECT_LIST_ID = APP_QM_SELECTLIST_PROD_PANEL.SELECT_LIST_ID 
	JOIN APP_QM_RESULT AS APP_QM_RESULT_PACK_PANEL
	ON APP_QM_SAMPLE.SAMPLE_ID = APP_QM_RESULT_PACK_PANEL.SAMPLE_ID 
	JOIN APP_QM_RESULT AS APP_QM_RESULT_PH
	ON APP_QM_SAMPLE.SAMPLE_ID = APP_QM_RESULT_PH.SAMPLE_ID 
	JOIN APP_PROCESS_ORDER
	ON APP_QM_SAMPLE.PROCESS_ORDER = APP_PROCESS_ORDER.PROCESS_ORDER 
	JOIN APP_PROCESS_ORDER_RESOURCE
	ON APP_PROCESS_ORDER.REQUIRED_RESOURCE = APP_PROCESS_ORDER_RESOURCE.REQUIRED_RESOURCE 
	JOIN APP_QM_DICTIONARY AS APP_QM_DICTIONARY_PACK_PANEL
	ON APP_QM_RESULT_PACK_PANEL.TEST_ID = APP_QM_DICTIONARY_PACK_PANEL.TEST_ID 
	JOIN APP_QM_SELECTLIST AS APP_QM_SELECTLIST_PACK_PANEL
	ON APP_QM_RESULT_PACK_PANEL.`VALUE` = APP_QM_SELECTLIST_PACK_PANEL.`VALUE`
	AND APP_QM_DICTIONARY_PACK_PANEL.SELECT_LIST_ID = APP_QM_SELECTLIST_PACK_PANEL.SELECT_LIST_ID
	WHERE
	APP_QM_RESULT_PROD_PANEL.TEST_ID = 'PANEL'
	AND APP_QM_RESULT_PACK_PANEL.TEST_ID = 'PACKAGING VERIFICATION'
	AND APP_QM_RESULT_PH.TEST_ID = 'PANEL PH'
	ORDER BY
	APP_PROCESS_ORDER_RESOURCE.BATCH_SUFFIX ASC,
	APP_QM_RESULT_PROD_PANEL.SAMPLE_ID ASC
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_QM_RESULT_ANALYSIS', 'EN', 'Results Analysis')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_QM_RESULT_ANALYSIS','DE','Results Analysis') 
</statement>
    
<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_QM_RESULT_ANALYSIS','FR','Results Analysis') 
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_QM_RESULT_ANALYSIS','NL','Results Analysis') 
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_QM_RESULT_ANALYSIS','PL','Results Analysis') 
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_QM_RESULT_ANALYSIS','IT','Results Analysis') 
</statement>
    
<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_QM_RESULT_ANALYSIS','HU','Results Analysis') 
</statement>   

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES  ('mod_FRM_QM_RESULT_ANALYSIS','ES',N'Results Analysis')
</statement> 

<statement>
	INSERT INTO SYS_MODULES (MODULE_ID,RF_ACTIVE,DK_ACTIVE,MODULE_TYPE,HINT,MNEMONIC,ICON_FILENAME,HELPSET_ID,REPORT_FILENAME,EXEC_FILENAME,EXEC_DIR,PRINT_PREVIEW,PRINT_DIALOG,PRINT_COPIES,REPORT_TYPE,RESOURCE_KEY) VALUES
		('FRM_QM_RESULT_ANALYSIS', 'N', 'Y', 'FORM', 'Results Analysis', '77', 'qm.gif', '', '', '', '', 'Y', 'N', '1', '', 'mod_FRM_QM_RESULT_ANALYSIS')
</statement>

<statement>
	INSERT INTO SYS_GROUP_PERMISSIONS (GROUP_ID,MODULE_ID) VALUES ('ADMIN', 'FRM_QM_RESULT_ANALYSIS')
</statement>

<statement>
	INSERT INTO SYS_GROUP_PERMISSIONS (GROUP_ID,MODULE_ID) VALUES ('QM', 'FRM_QM_RESULT_ANALYSIS')
</statement>

<statement>
	INSERT INTO SYS_MENUS (MODULE_ID,MENU_ID,SEQUENCE_ID) VALUES ('FRM_QM_RESULT_ANALYSIS','MENU_QM','7')
</statement>

</DDL>
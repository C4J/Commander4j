<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE DDL SYSTEM "schema.dtd">
<DDL>

	<statement>
		CREATE OR REPLACE VIEW "VIEW_PALLET_EXPIRY" AS ( SELECT
			P.SSCC, 
			P.LOCATION_ID, 
			P.MATERIAL, 
			P.BATCH_NUMBER, 
			P.PROCESS_ORDER, 
			P.QUANTITY, 
			P.UOM, 
			P.DATE_OF_MANUFACTURE, 
			P.STATUS, 
			P.EAN, 
			P.VARIANT, 
			P.DESPATCH_NO, 
			P.CONFIRMED, 
			P.LAYERS, 
			P.SSCC_EXPIRY_DATE, 
			P.CUSTOMER_ID, 
			P.MHN_NUMBER, 
			P.DECISION, 
			B.EXPIRY_DATE, 
			M.DESCRIPTION, 
			M.OLD_MATERIAL, 
			C.CUSTOMER_NAME, 
			C.PRINT_ON_LABEL, 
			P.DATE_CREATED, 
			P.CREATED_BY_USER_ID, 
			P.DATE_UPDATED, 
			P.UPDATED_BY_USER_ID, 
			P.EQUIPMENT_TYPE, 
			M.GROSS_WEIGHT, 
			M.NET_WEIGHT, 
			M.WEIGHT_UOM, 
			D.DATA PART_NO, 
			E.DATA CASE_CONTENT, 
			O.REQUIRED_RESOURCE REQUIRED_RESOURCE, 
			U2.EAN BASE_EAN, 
			U2.VARIANT BASE_VARIANT, 
			M.BASE_UOM BASE_UOM, 
			((P.QUANTITY * U.NUMERATOR ) / U.DENOMINATOR 	) BASE_QUANTITY
		FROM
			APP_PALLET P
			LEFT JOIN
			APP_MATERIAL M
			ON 
				P.MATERIAL = M.MATERIAL
			LEFT JOIN
			APP_MATERIAL_BATCH B
			ON 
				P.MATERIAL = B.MATERIAL AND
				P.BATCH_NUMBER = B.BATCH_NUMBER
			LEFT JOIN
			APP_PROCESS_ORDER O
			ON 
				P.PROCESS_ORDER = O.PROCESS_ORDER
			LEFT JOIN
			APP_CUSTOMER C
			ON 
				P.CUSTOMER_ID = C.CUSTOMER_ID
			LEFT JOIN
			APP_MATERIAL_CUSTOMER_DATA D
			ON 
				P.MATERIAL = D.MATERIAL AND
				P.CUSTOMER_ID = D.CUSTOMER_ID AND
				D.DATA_ID = 'PART_NO'
			LEFT JOIN
			APP_MATERIAL_CUSTOMER_DATA E
			ON 
				P.MATERIAL = E.MATERIAL AND
				P.CUSTOMER_ID = E.CUSTOMER_ID AND
				E.DATA_ID = 'CASE_CONTENT'
			LEFT JOIN
			APP_MATERIAL_UOM U
			ON 
				P.MATERIAL = U.MATERIAL AND
				P.UOM = U.UOM
			INNER JOIN
			APP_MATERIAL_UOM U2
			ON 
				P.MATERIAL = U2.MATERIAL AND
				M.BASE_UOM = U2.UOM )
	</statement>

</DDL>

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE DDL SYSTEM "schema.dtd">
<DDL>

   	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','EN','Error')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','DE','Fehler')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','FR','Erreur')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','NL','Fout')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','PL','Błąd')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','ES','Error')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','IT','Errore')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','HU','Hiba')</statement>
 
 	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','EN','Labeller History')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','DE','Etikettierer Geschichte')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','FR','Étiqueteuse Histoire')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','NL','Labeller Geschiedenis')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','PL','Etykietowania Historia')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','ES','Etiquetadora Historia')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','IT','Etichettatrice Storia')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','HU','Labeller története')</statement>
	
	<statement> 
		INSERT INTO SYS_MODULES (MODULE_ID, RF_ACTIVE, DK_ACTIVE, MODULE_TYPE, HINT, MNEMONIC, ICON_FILENAME, HELPSET_ID, REPORT_FILENAME, EXEC_FILENAME, EXEC_DIR, PRINT_PREVIEW, PRINT_DIALOG, PRINT_COPIES, REPORT_TYPE, RESOURCE_KEY) VALUES ('FRM_LABELLER_HISTORY', 'N', 'Y', 'FORM', 'mod_FRM_LABELLER_HISTORY', '0', 'prod_lines.gif', '', '', '', '', 'N', 'N', '1', '', 'mod_FRM_LABELLER_HISTORY')
	</statement> 

	<statement>
		INSERT INTO SYS_GROUP_PERMISSIONS (GROUP_ID, MODULE_ID) VALUES ('LABELS', 'FRM_LABELLER_HISTORY')
	</statement>
 
 
	<statement>
		INSERT INTO SYS_MODULES (MODULE_ID, RF_ACTIVE, DK_ACTIVE, MODULE_TYPE, HINT, ICON_FILENAME, HELPSET_ID, REPORT_FILENAME, EXEC_FILENAME, EXEC_DIR, PRINT_PREVIEW, PRINT_DIALOG, PRINT_COPIES, REPORT_TYPE, resource_key) VALUES ('FRM_ADMIN_AUTO_LAB_RENAME', 'N', 'Y', 'FUNCTION', '', '', '', '', '', '', 'Y', 'Y', 1, '', '')
	</statement>
 	
  	<statement>
		INSERT INTO SYS_GROUP_PERMISSIONS (GROUP_ID, MODULE_ID) VALUES ('ADMIN', 'FRM_ADMIN_AUTO_LAB_RENAME')
	</statement>      
	
	 <statement>
		INSERT INTO SYS_CONTROL (SYSTEM_KEY, KEY_VALUE,DESCRIPTION) VALUES ('INTERFACE BACKUP RETENTION', '30','NUMBER OF DAYS TO KEEP BACKUP MESSAGES')
	</statement>    
	
	<statement>
		INSERT INTO SYS_MODULES (MODULE_ID,RF_ACTIVE,DK_ACTIVE,MODULE_TYPE,HINT,MNEMONIC,ICON_FILENAME,HELPSET_ID,REPORT_FILENAME,EXEC_FILENAME,EXEC_DIR,PRINT_PREVIEW,PRINT_DIALOG,PRINT_COPIES,REPORT_TYPE,RESOURCE_KEY) VALUES
		('RPT_LABEL_HISTORY', 'N', 'Y', 'REPORT', 'Labeller History', '0', '', '', 'labeller_history.jrxml', '', '', 'Y', 'N', '1', 'Standard', 'mod_FRM_ADMIN_USER_REPORT')
	</statement>
	
	<statement>
		INSERT INTO SYS_GROUP_PERMISSIONS (GROUP_ID, MODULE_ID) VALUES ('LABELS', 'RPT_LABEL_HISTORY')
	</statement>

	<statement>
	  DROP TABLE APP_AUTO_LABELLER 
	</statement>
	
	<statement>
	  CREATE TABLE APP_AUTO_LABELLER 
	    (LINE VARCHAR2(20) NOT NULL, 
	    GROUP_ID VARCHAR2(15) DEFAULT 'Pack' NOT NULL,
		DESCRIPTION VARCHAR2(45), 
		SSCC_SEQUENCE NUMBER(18,0) DEFAULT 0, 
		USE_SSCC_RANGE VARCHAR2(1) DEFAULT 'N', 
		UNIQUE_ID VARCHAR2(40), 
		MODIFIED VARCHAR2(1) DEFAULT 'N', 
		VALIDATE_RESOURCE VARCHAR2(1) DEFAULT 'N')
	</statement>

	<statement>
  		CREATE UNIQUE INDEX APP_AUTO_LABELLER_PK ON APP_AUTO_LABELLER (LINE, GROUP_ID)
	</statement>
  
  	<statement>
  		ALTER TABLE APP_AUTO_LABELLER ADD CONSTRAINT APP_AUTO_LABELLER_PK PRIMARY KEY (LINE, GROUP_ID)	
	</statement>
	
	<statement>
		DROP TABLE APP_AUTO_LABELLER_RESOURCES
	</statement>

 	<statement>
	  	CREATE TABLE APP_AUTO_LABELLER_RESOURCES 
	   	("LINE" VARCHAR2(20) NOT NULL, 
	   	"GROUP_ID" VARCHAR2(15) DEFAULT 'Pack' NOT NULL ,
		"REQUIRED_RESOURCE" VARCHAR2(50) NOT NULL) 
	</statement>

 	<statement>
	   CREATE UNIQUE INDEX APP_AUTO_LABELLER_RESOURCES_PK ON APP_AUTO_LABELLER_RESOURCES ("LINE", "GROUP_ID", "REQUIRED_RESOURCE") 
	</statement>
	
	<statement>
		DROP TABLE SYS_PRINTER_LINE_MEMBERSHIP 
	</statement>
	
	<statement>
		  CREATE TABLE SYS_PRINTER_LINE_MEMBERSHIP 
		   	(	"LINE" VARCHAR2(20) NOT NULL, 
				"GROUP_ID" VARCHAR2(15)  DEFAULT 'Pack' NOT NULL,
			    "PRINTER_ID" VARCHAR2(20) NOT NULL
		   ) 
   	</statement>
 	
 	 <statement>
  		CREATE UNIQUE INDEX "SYS_PRINTER_LINE_MEMBER_PK" ON "SYS_PRINTER_LINE_MEMBERSHIP" ("LINE", "GROUP_ID", "PRINTER_ID" ) 
  	</statement>
	
	<statement>
  		ALTER TABLE "SYS_PRINTER_LINE_MEMBERSHIP" ADD CONSTRAINT "SYS_PRINTER_LINE_MEMBERSHI_PK" PRIMARY KEY ("LINE","GROUP_ID", "PRINTER_ID")
  	</statement>

	<statement>
		DELETE FROM SYS_MODULES WHERE MODULE_ID = 'FRM_ADMIN_LINE_PRINT'
	</statement>

	<statement>
		DELETE FROM SYS_GROUP_PERMISSIONS WHERE MODULE_ID = 'FRM_ADMIN_LINE_PRINT'
	</statement>

	<statement>
		DELETE FROM SYS_MENUS WHERE MODULE_ID = 'FRM_ADMIN_LINE_PRINT'
	</statement>
	
	<statement>
		DELETE FROM SYS_TOOLBAR WHERE MODULE_ID = 'FRM_ADMIN_LINE_PRINT'
	</statement>
	
	<statement>
	CREATE OR REPLACE VIEW VIEW_AUTO_LABELLER_PRINTER 
	AS 
	SELECT 
		  APP_AUTO_LABELLER.LINE,
		  APP_AUTO_LABELLER.MODIFIED,
		  APP_AUTO_LABELLER.UNIQUE_ID,
		  APP_LABEL_DATA.LABEL_TYPE,
		  SYS_PRINTER_LINE_MEMBERSHIP.PRINTER_ID, 
		  SYS_PRINTERS.ENABLED,
		  SYS_PRINTERS.PRINTER_TYPE,
		  SYS_PRINTERS.IP_ADDRESS,
		  SYS_PRINTERS.PORT,
		  SYS_PRINTERS.GROUP_ID,  
		  SYS_PRINTERS.LANGUAGE,
		  SYS_PRINTERS.PRINTER_DPI,
		  APP_LABEL_DATA.PROCESS_ORDER,
		  APP_LABEL_DATA.MATERIAL,
		  APP_LABEL_DATA.MATERIAL_TYPE,
		  APP_MATERIAL.DESCRIPTION AS MATERIAL_DESCRIPTION,
		  APP_MATERIAL.SHELF_LIFE_UOM,
		  APP_MATERIAL.SHELF_LIFE,
		  APP_MATERIAL.SHELF_LIFE_RULE,	  
		  APP_LABEL_DATA.BATCH_NUMBER,
		  APP_LABEL_DATA.REQUIRED_RESOURCE,
		  (SELECT KEY_VALUE FROM SYS_CONTROL WHERE SYSTEM_KEY = 'PLANT') AS PLANT,   	  	  
		  APP_LABEL_DATA.LOCATION_ID,
		  APP_LABEL_DATA.DATE_OF_MANUFACTURE,
		  APP_LABEL_DATA.EXPIRY_DATE,
		  APP_LABEL_DATA.PROD_EAN,
		  APP_LABEL_DATA.PROD_VARIANT,
		  APP_LABEL_DATA.PROD_QUANTITY,
		  APP_LABEL_DATA.PROD_UOM,
		  APP_LABEL_DATA.BASE_EAN,
		  APP_LABEL_DATA.BASE_QUANTITY,
		  APP_LABEL_DATA.BASE_VARIANT,
		  APP_LABEL_DATA.BASE_UOM,
		  APP_LABEL_DATA.CUSTOMER_ID,
		  APP_CUSTOMER.CUSTOMER_NAME,	  
		  APP_LABEL_DATA.PRINT_COPIES,
		  APP_LABEL_DATA.MODULE_ID,
		  APP_LABEL_DATA.OVERRIDE_MANUFACTURE_DATE,
		  APP_LABEL_DATA.OVERRIDE_EXPIRY_DATE,
		  APP_LABEL_DATA.OVERRIDE_BATCH_PREFIX,
		  APP_LABEL_DATA.BATCH_PREFIX,
		  APP_LABEL_DATA.BATCH_SUFFIX,
		  SYS_MODULES.MODULE_TYPE,
		  SYS_MODULES.REPORT_TYPE,
		  SYS_MODULES.REPORT_FILENAME
	FROM SYS_PRINTER_LINE_MEMBERSHIP
		INNER JOIN APP_AUTO_LABELLER ON SYS_PRINTER_LINE_MEMBERSHIP.LINE = APP_AUTO_LABELLER.LINE AND SYS_PRINTER_LINE_MEMBERSHIP.GROUP_ID = APP_AUTO_LABELLER.GROUP_ID
		INNER JOIN APP_LABEL_DATA ON APP_LABEL_DATA.UNIQUE_ID = APP_AUTO_LABELLER.UNIQUE_ID
		INNER JOIN SYS_PRINTERS ON SYS_PRINTERS.PRINTER_ID = SYS_PRINTER_LINE_MEMBERSHIP.PRINTER_ID AND SYS_PRINTERS.GROUP_ID = SYS_PRINTER_LINE_MEMBERSHIP.GROUP_ID
		INNER JOIN APP_MATERIAL ON APP_MATERIAL.MATERIAL = APP_LABEL_DATA.MATERIAL
		INNER JOIN APP_CUSTOMER ON APP_CUSTOMER.CUSTOMER_ID = APP_LABEL_DATA.CUSTOMER_ID
		INNER JOIN SYS_MODULES ON SYS_MODULES.MODULE_ID = APP_LABEL_DATA.MODULE_ID
	WHERE SYS_PRINTERS.ENABLED = 'Y'
	</statement>
		  
</DDL>

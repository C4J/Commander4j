<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE DDL SYSTEM "schema.dtd">
<DDL>

	<statement>
	  CREATE OR REPLACE FORCE VIEW view_pallet_expiry ("SSCC", "LOCATION_ID", "MATERIAL", "BATCH_NUMBER", "PROCESS_ORDER", "QUANTITY", "UOM", "DATE_OF_MANUFACTURE", "STATUS", "EAN", "VARIANT", "DESPATCH_NO", "CONFIRMED", "LAYERS", "SSCC_EXPIRY_DATE", "CUSTOMER_ID", "MHN_NUMBER", "DECISION", "EXPIRY_DATE", "DESCRIPTION", "OLD_MATERIAL", "CUSTOMER_NAME", "PRINT_ON_LABEL", "DATE_CREATED", "CREATED_BY_USER_ID", "DATE_UPDATED", "UPDATED_BY_USER_ID", "GROSS_WEIGHT", "NET_WEIGHT", "WEIGHT_UOM", "PART_NO") AS 
	  (SELECT P."SSCC",
	  P."LOCATION_ID",
	  P."MATERIAL",
	  P."BATCH_NUMBER",
	  P."PROCESS_ORDER",
	  P."QUANTITY",
	  P."UOM",
	  P."DATE_OF_MANUFACTURE",
	  P."STATUS",
	  P."EAN",
	  P."VARIANT",
	  P."DESPATCH_NO",
	  P."CONFIRMED",
	  P."LAYERS",
	  P."SSCC_EXPIRY_DATE",
	  P."CUSTOMER_ID",
	  P."MHN_NUMBER",
	  P."DECISION",
	  B.EXPIRY_DATE,
	  M.DESCRIPTION,
	  M.OLD_MATERIAL,
	  C.CUSTOMER_NAME,
	  C.PRINT_ON_LABEL,
	  p.DATE_CREATED,
	  P.CREATED_BY_USER_ID,
	  P.DATE_UPDATED,
	  P.UPDATED_BY_USER_ID,
	  M.GROSS_WEIGHT,
	  M.NET_WEIGHT,
	  M.WEIGHT_UOM,
	  D.DATA AS PART_NO,
	  E.DATA AS CASE_CONTENT
	  FROM APP_PALLET P
	  LEFT JOIN APP_MATERIAL_BATCH B ON (P.MATERIAL = B.MATERIAL AND P.BATCH_NUMBER = B.BATCH_NUMBER)
	  LEFT JOIN APP_MATERIAL M ON P.MATERIAL = M.MATERIAL
	  LEFT JOIN APP_CUSTOMER C ON P.CUSTOMER_ID = C.CUSTOMER_ID
	  LEFT JOIN APP_MATERIAL_CUSTOMER_DATA D ON (D.MATERIAL = P.MATERIAL AND D.CUSTOMER_ID = P.CUSTOMER_ID and D.DATA_ID = 'PART_NO')
	  LEFT JOIN APP_MATERIAL_CUSTOMER_DATA E ON (E.MATERIAL = P.MATERIAL AND E.CUSTOMER_ID = P.CUSTOMER_ID and E.DATA_ID = 'CASE_CONTENT')
	  )
	</statement>
	
</DDL>
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE DDL SYSTEM "schema.dtd">
<DDL>

<statement>
	ALTER TABLE APP_MHN ADD WRITE_OFF_REF VARCHAR2(20) DEFAULT ''
</statement>

<statement>
	ALTER TABLE APP_QM_SAMPLE ADD USER_DATA_3 VARCHAR2(20) DEFAULT ''
</statement>

<statement>
	ALTER TABLE APP_QM_SAMPLE ADD USER_DATA_4 VARCHAR2(20) DEFAULT ''
</statement>

<statement>
	UPDATE APP_QM_SAMPLE SET USER_DATA_3 = ''
</statement>

<statement>
	UPDATE APP_QM_SAMPLE SET USER_DATA_4 = ''
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Write_Off_Ref', 'EN', 'Write Off Ref', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Write_Off_Ref', 'NL', 'Write Off Ref', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Write_Off_Ref', 'HU', 'Write Off Ref', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Write_Off_Ref', 'IT', 'Write Off Ref', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Write_Off_Ref', 'DE', 'Write Off Ref', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Write_Off_Ref', 'ES', 'Write Off Ref', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Write_Off_Ref', 'PL', 'Write Off Ref', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data3', 'EN', 'Shift ID', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data3', 'NL', 'Shift ID', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data3', 'HU', 'Shift ID', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data3', 'IT', 'Shift ID', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data3', 'DE', 'Shift ID', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data3', 'ES', 'Shift ID', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data3', 'PL', 'Shift ID', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data4', 'EN', 'Product Group', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data4', 'NL', 'Product Group', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data4', 'HU', 'Product Group', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data4', 'IT', 'Product Group', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data4', 'DE', 'Product Group', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data4', 'ES', 'Product Group', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_User_Data4', 'PL', 'Product Group', 'Q')
</statement>

<statement>
  CREATE OR REPLACE FORCE VIEW "VIEW_QM_RESULTS" AS 
  (SELECT samp.PROCESS_ORDER as "PROCESS_ORDER",
       samp.MATERIAL as "MATERIAL",
       samp.SAMPLE_ID as "SAMPLE_ID",    
       samp.SAMPLE_DATE as "SAMPLE_DATE",
       samp.USER_DATA_1 as "USER_DATA_1",
       samp.USER_DATA_2 as "USER_DATA_2",
       samp.USER_DATA_3 as "USER_DATA_3",
       samp.USER_DATA_4 as "USER_DATA_4",
       result.TEST_ID as "TEST_ID",
       dict.DESCRIPTION as "TEST_DESCRIPTION",
       result.VALUE as "VALUE",
       COALESCE(valist.DESCRIPTION,result.VALUE) AS "RESULT"
FROM APP_QM_SAMPLE samp 
LEFT JOIN APP_QM_RESULT result ON (result.SAMPLE_ID = samp.SAMPLE_ID)
LEFT JOIN APP_QM_DICTIONARY dict ON (dict.TEST_ID = result.TEST_ID)
LEFT JOIN APP_QM_SELECTLIST valist ON (valist.SELECT_LIST_ID = dict.SELECT_LIST_ID AND valist.VALUE = result.VALUE))
</statement>

<statement>
	INSERT INTO APP_MATERIAL_DATA_IDS (DATA_ID,DESCRIPTION) VALUES ('CONTAINER_CODE', 'Container Code')
</statement>

<statement>
	INSERT INTO APP_MATERIAL_DATA_IDS (DATA_ID,DESCRIPTION) VALUES ('PRODUCT_GROUP', 'Product Group')
</statement>

<statement>
	ALTER TABLE SYS_USER_REPORTS MODIFY USER_REPORT_ID VARCHAR2(45)
</statement>

<statement>
	INSERT INTO SYS_USER_REPORTS VALUES ('USER_DATA_1', '0', 'USER_DATA_1 (SAMPLE LABEL)', 'SELECT
	APP_MATERIAL_CUSTOMER_DATA.DATA
	FROM
	APP_MATERIAL_CUSTOMER_DATA
	RIGHT JOIN APP_PROCESS_ORDER
	ON APP_MATERIAL_CUSTOMER_DATA.MATERIAL = APP_PROCESS_ORDER.MATERIAL
	AND APP_MATERIAL_CUSTOMER_DATA.CUSTOMER_ID = APP_PROCESS_ORDER.CUSTOMER_ID
	WHERE APP_PROCESS_ORDER.PROCESS_ORDER = ''123'' 
	AND APP_MATERIAL_CUSTOMER_DATA.DATA_ID = ''CONTAINER_CODE''', null, 'SYSTEM', 'Y', 'N', 'DAVID', null, 'N', null, 'N', 'N', 'N', 'N', null)
</statement>

<statement>
CREATE OR REPLACE FORCE VIEW "VIEW_QM_ANALYSIS_01" ("BATCH_SUFFIX", "RESOURCE_DESCRIPTION", "SAMPLE_DATE", "SAMPLE_ID", "PROCESS_ORDER", "REQUIRED_RESOURCE", "MATERIAL", "USER_DATA_1", "USER_DATA_2", "USER_DATA_3", "USER_DATA_4", "PROD_PANEL", "VALUE") AS 
  SELECT
	"APP_PROCESS_ORDER_RESOURCE"."BATCH_SUFFIX",
    "APP_PROCESS_ORDER_RESOURCE".DESCRIPTION AS "RESOURCE_DESCRIPTION",
	"APP_QM_SAMPLE"."SAMPLE_DATE",
	"APP_QM_SAMPLE"."SAMPLE_ID",
	"APP_QM_SAMPLE"."PROCESS_ORDER",
    "APP_PROCESS_ORDER"."REQUIRED_RESOURCE",
	"APP_QM_SAMPLE".MATERIAL,
	"APP_QM_SAMPLE"."USER_DATA_1" AS "USER_DATA_1",
	"APP_QM_SAMPLE"."USER_DATA_2" AS "USER_DATA_2",
	"APP_QM_SAMPLE"."USER_DATA_3" AS "USER_DATA_3",
	"APP_QM_SAMPLE"."USER_DATA_4" AS "USER_DATA_4",
	"APP_QM_SELECTLIST_PROD".DESCRIPTION AS "PROD_PANEL",
    "APP_QM_RESULT_PH"."VALUE"
	FROM "APP_QM_SAMPLE"
	JOIN "APP_QM_RESULT" "APP_QM_RESULT_PH" ON ("APP_QM_SAMPLE"."SAMPLE_ID" = "APP_QM_RESULT_PH"."SAMPLE_ID")
	JOIN "APP_QM_RESULT" "APP_QM_RESULT_PROD" ON ("APP_QM_SAMPLE"."SAMPLE_ID" = "APP_QM_RESULT_PROD"."SAMPLE_ID")
	JOIN "APP_QM_RESULT" "APP_QM_RESULT_PACK" ON ("APP_QM_SAMPLE"."SAMPLE_ID" = "APP_QM_RESULT_PACK"."SAMPLE_ID")
	JOIN "APP_QM_DICTIONARY" "APP_QM_DICTIONARY_PROD" ON ("APP_QM_RESULT_PROD"."TEST_ID" = "APP_QM_DICTIONARY_PROD"."TEST_ID")
	JOIN "APP_QM_SELECTLIST" "APP_QM_SELECTLIST_PROD" ON ("APP_QM_DICTIONARY_PROD"."SELECT_LIST_ID" = "APP_QM_SELECTLIST_PROD"."SELECT_LIST_ID")
	AND ("APP_QM_RESULT_PROD"."VALUE" = "APP_QM_SELECTLIST_PROD"."VALUE")
	JOIN "APP_QM_DICTIONARY" "APP_QM_DICTIONARY_PACK" ON ("APP_QM_RESULT_PACK"."TEST_ID" = "APP_QM_DICTIONARY_PACK"."TEST_ID")
	JOIN "APP_QM_SELECTLIST" "APP_QM_SELECTLIST_PACK" ON ("APP_QM_DICTIONARY_PACK"."SELECT_LIST_ID" = "APP_QM_SELECTLIST_PACK"."SELECT_LIST_ID")
	AND ("APP_QM_RESULT_PACK"."VALUE" = "APP_QM_SELECTLIST_PACK"."VALUE")
	JOIN "APP_PROCESS_ORDER" ON ("APP_QM_SAMPLE"."PROCESS_ORDER" = "APP_PROCESS_ORDER"."PROCESS_ORDER")
	JOIN "APP_PROCESS_ORDER_RESOURCE" ON ("APP_PROCESS_ORDER"."REQUIRED_RESOURCE" = "APP_PROCESS_ORDER_RESOURCE"."REQUIRED_RESOURCE")
	WHERE
	APP_QM_RESULT_PROD.TEST_ID = 'PANEL'
	AND APP_QM_RESULT_PACK.TEST_ID = 'PACKAGING VERIFICATION'
	AND APP_QM_RESULT_PH.TEST_ID = 'PANEL PH'
	ORDER BY
	APP_PROCESS_ORDER_RESOURCE.BATCH_SUFFIX,
	APP_QM_RESULT_PROD.SAMPLE_ID
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_QM_RESULT_ANALYSIS', 'EN', 'Results Analysis')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_QM_RESULT_ANALYSIS','DE','Results Analysis') 
</statement>
    
<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_QM_RESULT_ANALYSIS','FR','Results Analysis') 
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_QM_RESULT_ANALYSIS','NL','Results Analysis') 
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_QM_RESULT_ANALYSIS','PL','Results Analysis') 
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_QM_RESULT_ANALYSIS','IT','Results Analysis') 
</statement>
    
<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_QM_RESULT_ANALYSIS','HU','Results Analysis') 
</statement>   

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES  ('mod_FRM_QM_RESULT_ANALYSIS','ES',N'Results Analysis')
</statement> 

<statement>
	INSERT INTO SYS_MODULES (MODULE_ID,RF_ACTIVE,DK_ACTIVE,MODULE_TYPE,HINT,MNEMONIC,ICON_FILENAME,HELPSET_ID,REPORT_FILENAME,EXEC_FILENAME,EXEC_DIR,PRINT_PREVIEW,PRINT_DIALOG,PRINT_COPIES,REPORT_TYPE,RESOURCE_KEY) VALUES
		('FRM_QM_RESULT_ANALYSIS', 'N', 'Y', 'FORM', 'Results Analysis', '77', 'qm.gif', '', '', '', '', 'Y', 'N', '1', '', 'mod_FRM_QM_RESULT_ANALYSIS')
</statement>

<statement>
	INSERT INTO SYS_GROUP_PERMISSIONS (GROUP_ID,MODULE_ID) VALUES ('ADMIN', 'FRM_QM_RESULT_ANALYSIS')
</statement>

<statement>
	INSERT INTO SYS_GROUP_PERMISSIONS (GROUP_ID,MODULE_ID) VALUES ('QM', 'FRM_QM_RESULT_ANALYSIS')
</statement>

<statement>
	INSERT INTO SYS_MENUS (MODULE_ID,MENU_ID,SEQUENCE_ID) VALUES ('FRM_QM_RESULT_ANALYSIS','MENU_QM','7')
</statement>

<statement>
 CREATE TABLE "APP_QM_ANALYSIS" 
   (	"ANALYSIS_ID" VARCHAR2(25 BYTE) NOT NULL ENABLE, 
	"DESCRIPTION" VARCHAR2(80 BYTE), 
	"VIEW_NAME" VARCHAR2(80 BYTE), 
	"SORT_BY" VARCHAR2(125 BYTE), 
	"ASC_DESC" VARCHAR2(1 BYTE), 
	"FIELD_LIST" VARCHAR2(250 BYTE), 
	"MERGE_SPREADSHEET" VARCHAR2(45 BYTE), 
	"DISPLAY_SEQUENCE" NUMBER, 
	 CONSTRAINT "APP_QM_ANALYSIS_PK" PRIMARY KEY ("ANALYSIS_ID")
</statement>

</DDL>
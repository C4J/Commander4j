<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE DDL SYSTEM "schema.dtd">
<DDL>
	
	<statement>
		ALTER TABLE `APP_AUTO_LABELLER` ADD COLUMN `PREFIX_CODE` VARCHAR(4) NULL DEFAULT '' AFTER `VALIDATE_WORKSTATION`;
	</statement>	
	
	<statement>
		UPDATE APP_AUTO_LABELLER SET PREFIX_CODE = ''
	</statement>
	
	<statement>	
		INSERT INTO SYS_LANGUAGE(RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Prefix_Code', 'EN', 'Prefix Code', '0')
	</statement>
	
	<statement>	
		INSERT INTO SYS_LANGUAGE(RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Prefix_Code', 'FR', 'Code de préfixe', '0')
	</statement>
	
	<statement>	
		INSERT INTO SYS_LANGUAGE(RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Prefix_Code', 'DE', 'Präfix-Code', '0')
	</statement>
	
	<statement>	
		INSERT INTO SYS_LANGUAGE(RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Prefix_Code', 'HU', 'Előtagkód', '0')
	</statement>
	
	<statement>	
		INSERT INTO SYS_LANGUAGE(RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Prefix_Code', 'PL', 'Kod prefiksu', '0')
	</statement>
	
	<statement>	
		INSERT INTO SYS_LANGUAGE(RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Prefix_Code', 'IT', 'Prefisso', '0')
	</statement>
	
	<statement>	
		INSERT INTO SYS_LANGUAGE(RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Prefix_Code', 'NL', 'Prefixcode', '0')
	</statement>
	
	<statement>	
		INSERT INTO SYS_LANGUAGE(RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Prefix_Code', 'SP', 'Código de prefijo', '0')
	</statement>
	
	<statement>	
			CREATE OR REPLACE VIEW `view_sync4b` AS
			SELECT
				`app_label_data`.`UNIQUE_ID` AS `UNIQUE_ID`,
				`app_label_data`.`LINE` AS `LINE`,
				`view_sync4a`.`LABEL_TYPE` AS `LABEL_TYPE`,
				`app_auto_labeller`.`PREFIX_CODE` AS `PREFIX_CODE`,
				`app_label_data`.`USER_ID` AS `USER_ID`,
				`app_label_data`.`WORKSTATION_ID` AS `WORKSTATION_ID`,
				`view_sync4a`.`PROCESS_ORDER` AS `PROCESS_ORDER`,
				`app_label_data`.`REQUIRED_RESOURCE` AS `REQUIRED_RESOURCE`,
				`view_sync4a`.`MATERIAL` AS `MATERIAL`,
				`app_label_data`.`MATERIAL_TYPE` AS `MATERIAL_TYPE`,
				`app_material`.`DESCRIPTION` AS `DESCRIPTION`,
				`view_sync4a`.`BATCH_NUMBER` AS `BATCH_NUMBER`,
				`app_label_data`.`BATCH_PREFIX` AS `BATCH_PREFIX`,
				`app_label_data`.`BATCH_SUFFIX` AS `BATCH_SUFFIX`,
				`app_process_order`.`STATUS` AS `STATUS`,
				`app_process_order`.`REQUIRED_UOM` AS `REQUIRED_UOM`,
				`app_label_data`.`PRINT_DATE` AS `PRINT_DATE`,
				`app_label_data`.`PROD_EAN` AS `PROD_EAN`,
				`app_label_data`.`PROD_VARIANT` AS `PROD_VARIANT`,
				`app_label_data`.`PROD_QUANTITY` AS `PROD_QUANTITY`,
				`app_label_data`.`BASE_EAN` AS `BASE_EAN`,
				`app_label_data`.`BASE_VARIANT` AS `BASE_VARIANT`,
				`app_label_data`.`BASE_QUANTITY` AS `BASE_QUANTITY`,
				`app_label_data`.`DATE_OF_MANUFACTURE` AS `DATE_OF_MANUFACTURE`,
				`app_label_data`.`EXPIRY_DATE` AS `EXPIRY_DATE`,
				`app_material`.`UPDATED` AS `MATERIAL_UPDATED`,
				`app_process_order`.`UPDATED` AS `PROCESS_ORDER_UPDATED`,
				`app_customer`.`CUSTOMER_ID` AS `CUSTOMER_ID`,
				`app_customer`.`CUSTOMER_NAME` AS `CUSTOMER_NAME`,
				`app_label_data`.`OVERRIDE_MANUFACTURE_DATE` AS `OVERRIDE_MANUFACTURE_DATE`,
				`app_label_data`.`OVERRIDE_EXPIRY_DATE` AS `OVERRIDE_EXPIRY_DATE`,
				`app_label_data`.`OVERRIDE_BATCH_PREFIX` AS `OVERRIDE_BATCH_PREFIX`,
				`app_material`.`OVERRIDE_PACK_LABEL` AS `OVERRIDE_PACK_LABEL`,
				`app_material`.`PACK_LABEL_MODULE_ID` AS `PACK_LABEL_MODULE_ID`,
				`app_material`.`OVERRIDE_PALLET_LABEL` AS `OVERRIDE_PALLET_LABEL`,
				`app_material`.`PALLET_LABEL_MODULE_ID` AS `PALLET_LABEL_MODULE_ID`,
				`app_label_data`.`LAYERS` AS `LAYERS`,
				`view_sync4a`.`PRINTER_ID` AS `PRINTER_ID`,
				`sys_printers`.`PRINTER_ID` AS `PRINTER_ID_0`,
				`sys_printers`.`PRINTER_TYPE` AS `PRINTER_TYPE`,
				`sys_printers`.`IP_ADDRESS` AS `IP_ADDRESS`,
				`sys_printers`.`PORT` AS `PORT`,
				`sys_printers`.`ENABLED` AS `ENABLED`,
				`sys_printers`.`PRINTER_DPI` AS `PRINTER_DPI`,
				`sys_printers`.`PAPER_SIZE` AS `PAPER_SIZE` 
			FROM
				(
					(
						(
							(
								(
									(
										`app_label_data`
										JOIN `view_sync4a` ON (
											(
												( `app_label_data`.`PROCESS_ORDER` = `view_sync4a`.`PROCESS_ORDER` ) 
												AND ( `app_label_data`.`MATERIAL` = `view_sync4a`.`MATERIAL` ) 
												AND ( `app_label_data`.`BATCH_NUMBER` = `view_sync4a`.`BATCH_NUMBER` ) 
												AND ( `app_label_data`.`LABEL_TYPE` = `view_sync4a`.`LABEL_TYPE` ) 
												AND ( `app_label_data`.`LINE` = `view_sync4a`.`LINE` ) 
											) 
										) 
									)
									JOIN `app_process_order` ON ( ( `app_process_order`.`PROCESS_ORDER` = `view_sync4a`.`PROCESS_ORDER` ) ) 
								)
								JOIN `app_customer` ON ( ( `app_customer`.`CUSTOMER_ID` = `app_process_order`.`CUSTOMER_ID` ) ) 
							)
							JOIN `app_material` ON ( ( `app_material`.`MATERIAL` = `view_sync4a`.`MATERIAL` ) ) 
						)
						JOIN `app_auto_labeller` ON (
							(
								( `app_auto_labeller`.`LINE` = `view_sync4a`.`LINE` ) 
								AND ( `app_auto_labeller`.`GROUP_ID` = `view_sync4a`.`LABEL_TYPE` ) 
							) 
						) 
					)
					JOIN `sys_printers` ON ( ( `sys_printers`.`PRINTER_ID` = `view_sync4a`.`PRINTER_ID` ) ) 
				) 
			WHERE
				(
					( `app_process_order`.`STATUS` = 'Ready' ) 
				AND ( `app_label_data`.`LINE` > '' ) 
				)
	</statement>
	
</DDL>
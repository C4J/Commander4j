<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE DDL SYSTEM "schema.dtd">
<DDL>

<statement>
	CREATE TABLE `SYS_MODULES_ALTERNATIVE` (
	  `MODULE_ID` VARCHAR(35) NOT NULL,
	  `WORKSTATION_ID` VARCHAR(40) NOT NULL,
	  `ALT_MODULE_ID` VARCHAR(35) NOT NULL,
	  PRIMARY KEY (`MODULE_ID`, `WORKSTATION_ID`));
</statement>

<statement> 
	INSERT INTO SYS_MODULES (MODULE_ID, RF_ACTIVE, DK_ACTIVE, MODULE_TYPE, HINT, MNEMONIC, ICON_FILENAME, HELPSET_ID, REPORT_FILENAME, EXEC_FILENAME, EXEC_DIR, PRINT_PREVIEW, PRINT_DIALOG, PRINT_COPIES, REPORT_TYPE, RESOURCE_KEY) VALUES ('FRM_ADMIN_MODULE_ALTERNATE', 'N', 'Y', 'FORM', 'btn_Alternative', '0', 'alternative.gif', '', '', '', '', 'N', 'N', '1', '', 'mod_FRM_ADMIN_MODULE_GROUPS')
</statement> 	
	
<statement>
	INSERT INTO SYS_GROUP_PERMISSIONS (GROUP_ID, MODULE_ID) VALUES ('ADMIN', 'FRM_ADMIN_MODULE_ALTERNATE')
</statement>

<statement> 
	INSERT INTO SYS_MODULES (MODULE_ID, RF_ACTIVE, DK_ACTIVE, MODULE_TYPE, HINT, MNEMONIC, ICON_FILENAME, HELPSET_ID, REPORT_FILENAME, EXEC_FILENAME, EXEC_DIR, PRINT_PREVIEW, PRINT_DIALOG, PRINT_COPIES, REPORT_TYPE, RESOURCE_KEY) VALUES ('FRM_ADMIN_MODULE_COPY', 'N', 'Y', 'FUNCTION', NULL, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'btn_Copy')
</statement> 	
	
<statement>
	INSERT INTO SYS_GROUP_PERMISSIONS (GROUP_ID, MODULE_ID) VALUES ('ADMIN', 'FRM_ADMIN_MODULE_COPY')
</statement>

<statement>
	DELETE FROM SYS_ARCHIVE WHERE ARCHIVE_ID = 'INT_LOG'
</statement>

<statement>
	INSERT INTO SYS_ARCHIVE (ARCHIVE_ID,DESCRIPTION,ENABLED,BACKGROUND_TASK,RETENTION_DAYS,SQL_TABLE,SQL_CRITERIA,SEQUENCE) VALUES 
	                        ('INT_LOG','System Interface Log','Y','Y',30,'SYS_INTERFACE_LOG','EVENT_TIME &lt; ?',10)
</statement>

<statement>
	DELETE FROM SYS_ARCHIVE WHERE ARCHIVE_ID = 'JOURNEY_REF'
</statement>

<statement>
	INSERT INTO SYS_ARCHIVE (ARCHIVE_ID,DESCRIPTION,ENABLED,BACKGROUND_TASK,RETENTION_DAYS,SQL_TABLE,SQL_CRITERIA,SEQUENCE) VALUES 
	                        ('JOURNEY_REF','Journey Refs','Y','Y',2,'APP_JOURNEY','STATUS = ''Unassigned'' AND TIMESLOT &lt; ?',20)
</statement>

<statement>
	create view view_permissions as
	SELECT
	SYS_USERS.USER_ID,
	SYS_USERS.USER_COMMENT,
	SYS_GROUPS.GROUP_ID,
	SYS_GROUPS.DESCRIPTION,
	SYS_MODULES.MODULE_ID,
	SYS_MODULES.MODULE_TYPE,
	SYS_LANGUAGE.TEXT,
	SYS_MODULES.DK_ACTIVE,
	SYS_MODULES.RF_ACTIVE
	FROM
	SYS_USER_GROUP_MEMBERSHIP
	RIGHT JOIN SYS_USERS
	ON SYS_USER_GROUP_MEMBERSHIP.USER_ID = SYS_USERS.USER_ID 
	RIGHT JOIN SYS_GROUPS
	ON SYS_GROUPS.GROUP_ID = SYS_USER_GROUP_MEMBERSHIP.GROUP_ID 
	RIGHT JOIN SYS_GROUP_PERMISSIONS
	ON SYS_GROUP_PERMISSIONS.GROUP_ID = SYS_GROUPS.GROUP_ID 
	RIGHT JOIN SYS_MODULES
	ON SYS_MODULES.MODULE_ID = SYS_GROUP_PERMISSIONS.MODULE_ID 
	LEFT JOIN SYS_LANGUAGE
	ON SYS_LANGUAGE.RESOURCE_KEY = SYS_MODULES.RESOURCE_KEY
	AND SYS_LANGUAGE.LANGUAGE_ID = SYS_USERS.LANGUAGE_ID
	WHERE
	ACCOUNT_ENABLED = 'Y' AND (ACCOUNT_EXPIRES = 'N' OR (ACCOUNT_EXPIRES = 'Y' AND ACCOUNT_EXPIRY_DATE > CURDATE()))
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('btn_Export', 'EN', 'Export', '')
</statement>

<statement>
		INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('btn_Alternative','EN','Alternative','')
</statement>

<statement> 
	INSERT INTO SYS_MODULES (MODULE_ID, RF_ACTIVE, DK_ACTIVE, MODULE_TYPE, HINT, MNEMONIC, ICON_FILENAME, HELPSET_ID, REPORT_FILENAME, EXEC_FILENAME, EXEC_DIR, PRINT_PREVIEW, PRINT_DIALOG, PRINT_COPIES, REPORT_TYPE, RESOURCE_KEY) VALUES ('FRM_ADMIN_USER_PERM_EXPORT', 'N', 'Y', 'FUNCTION', NULL, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'btn_Export')
</statement> 	
	
<statement>
	INSERT INTO SYS_GROUP_PERMISSIONS (GROUP_ID, MODULE_ID) VALUES ('ADMIN', 'FRM_ADMIN_USER_PERM_EXPORT')
</statement>

</DDL>
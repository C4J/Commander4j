<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE DDL SYSTEM "schema.dtd">
<DDL>

   	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','EN','Error')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','DE','Fehler')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','FR','Erreur')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','NL','Fout')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','PL','Błąd')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','ES','Error')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','IT','Errore')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('err_Error','HU','Hiba')</statement>
	
	
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','EN','Labeller History')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','DE','Etikettierer Geschichte')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','FR','Étiqueteuse Histoire')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','NL','Labeller Geschiedenis')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','PL','Etykietowania Historia')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','ES','Etiquetadora Historia')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','IT','Etichettatrice Storia')</statement>
	<statement>INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT) VALUES ('mod_FRM_LABELLER_HISTORY','HU','Labeller története')</statement>
	
	<statement> 
		INSERT INTO SYS_MODULES (MODULE_ID, RF_ACTIVE, DK_ACTIVE, MODULE_TYPE, HINT, MNEMONIC, ICON_FILENAME, HELPSET_ID, REPORT_FILENAME, EXEC_FILENAME, EXEC_DIR, PRINT_PREVIEW, PRINT_DIALOG, PRINT_COPIES, REPORT_TYPE, RESOURCE_KEY) VALUES ('FRM_LABELLER_HISTORY', 'N', 'Y', 'FORM', 'mod_FRM_LABELLER_HISTORY', '0', 'prod_lines.gif', '', '', '', '', 'N', 'N', '1', '', 'mod_FRM_LABELLER_HISTORY')
	</statement> 

	<statement>
		INSERT INTO SYS_GROUP_PERMISSIONS (GROUP_ID, MODULE_ID) VALUES ('LABELS', 'FRM_LABELLER_HISTORY')
	</statement>
	
	<statement>
		INSERT INTO SYS_MODULES (MODULE_ID, RF_ACTIVE, DK_ACTIVE, MODULE_TYPE, HINT, ICON_FILENAME, HELPSET_ID, REPORT_FILENAME, EXEC_FILENAME, EXEC_DIR, PRINT_PREVIEW, PRINT_DIALOG, PRINT_COPIES, REPORT_TYPE, resource_key) VALUES ('FRM_ADMIN_AUTO_LAB_RENAME', 'N', 'Y', 'FUNCTION', '', '', '', '', '', '', 'Y', 'Y', 1, '', '')
	</statement>
	
  	<statement>
		INSERT INTO SYS_GROUP_PERMISSIONS (GROUP_ID, MODULE_ID) VALUES ('ADMIN', 'FRM_ADMIN_AUTO_LAB_RENAME')
	</statement>  
	
	 <statement>
		INSERT INTO SYS_CONTROL (SYSTEM_KEY, KEY_VALUE,DESCRIPTION) VALUES ('INTERFACE BACKUP RETENTION', '30','NUMBER OF DAYS TO KEEP BACKUP MESSAGES')
	</statement>
	
	<statement>
		INSERT INTO SYS_MODULES (MODULE_ID,RF_ACTIVE,DK_ACTIVE,MODULE_TYPE,HINT,MNEMONIC,ICON_FILENAME,HELPSET_ID,REPORT_FILENAME,EXEC_FILENAME,EXEC_DIR,PRINT_PREVIEW,PRINT_DIALOG,PRINT_COPIES,REPORT_TYPE,RESOURCE_KEY) VALUES
		('RPT_LABEL_HISTORY', 'N', 'Y', 'REPORT', 'Labeller History', '0', '', '', 'labeller_history.jrxml', '', '', 'Y', 'N', '1', 'Standard', 'mod_FRM_ADMIN_USER_REPORT')
	</statement>
	
	<statement>
		INSERT INTO SYS_GROUP_PERMISSIONS (GROUP_ID, MODULE_ID) VALUES ('LABELS', 'RPT_LABEL_HISTORY')
	</statement>
	
	<statement>
		sp_RENAME 'APP_AUTO_LABELLER' , 'XAPP_AUTO_LABELLER'
	</statement>
	
	<statement>
		CREATE TABLE [dbo].[APP_AUTO_LABELLER](
		[LINE] [varchar](20) NOT NULL,
		[GROUP_ID] [varchar](15) NOT NULL DEFAULT ('Pack'),
		[DESCRIPTION] [varchar](45) NULL,
		[SSCC_SEQUENCE] [numeric](18, 0) NULL DEFAULT ((0)),
		[USE_SSCC_RANGE] [varchar](1) NULL DEFAULT ('N'),
		[UNIQUE_ID] [varchar](40) NULL,
		[MODIFIED] [varchar](1) NULL DEFAULT ('N'),
		[VALIDATE_RESOURCE] [varchar](1) NULL DEFAULT ('N'),
	 CONSTRAINT [PK_APP_AUTO_LABELLER2] PRIMARY KEY CLUSTERED 
		(
			[LINE] ASC,
			[GROUP_ID] ASC
		)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
		) ON [PRIMARY]
	</statement>
	
	<statement>
		INSERT INTO APP_AUTO_LABELLER (LINE,GROUP_ID,DESCRIPTION,SSCC_SEQUENCE,USE_SSCC_RANGE,UNIQUE_ID,MODIFIED,VALIDATE_RESOURCE) SELECT LINE,'Pack' AS GROUP_ID,DESCRIPTION,SSCC_SEQUENCE,USE_SSCC_RANGE,UNIQUE_ID,MODIFIED,VALIDATE_RESOURCE FROM XAPP_AUTO_LABELLER
	</statement>

	<statement>
		DROP TABLE XAPP_AUTO_LABELLER
	</statement>
	
	<statement>
		DROP TABLE APP_AUTO_LABELLER_RESOURCES
	</statement>
	
	<statement>
		CREATE TABLE [APP_AUTO_LABELLER_RESOURCES](
			[LINE] [varchar](20) NOT NULL,
			[GROUP_ID] [varchar](15) NOT NULL,
			[REQUIRED_RESOURCE] [varchar](50) NOT NULL,
		 CONSTRAINT [PK_APP_AUTO_LABELLER_RESOURCES] PRIMARY KEY CLUSTERED 
		(
			[LINE] ASC,
			[GROUP_ID] ASC,
			[REQUIRED_RESOURCE] ASC
		)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
		) ON [PRIMARY]
	</statement>
	
	<statement>
		ALTER TABLE [APP_AUTO_LABELLER_RESOURCES] ADD  CONSTRAINT [DF_APP_AUTO_LABELLER_RESOURCES_GROUP_ID]  DEFAULT ('Pack') FOR [GROUP_ID]	
	</statement>
	
	<statement>
		UPDATE APP_AUTO_LABELLER_RESOURCES SET GROUP_ID = 'Pack'
	</statement>

	<statement>	
		DROP TABLE [SYS_PRINTER_LINE_MEMBERSHIP]
	</statement>	
	
	<statement>	
		CREATE TABLE [SYS_PRINTER_LINE_MEMBERSHIP](
			[LINE] [varchar](20) NOT NULL,
			[GROUP_ID] [varchar](15) NOT NULL,
			[PRINTER_ID] [varchar](20) NOT NULL,
		 CONSTRAINT [PK_SYS_PRINTER_LINE_MEMBERSHIP_1] PRIMARY KEY CLUSTERED 
		(
			[LINE] ASC,
			[GROUP_ID] ASC,
			[PRINTER_ID] ASC
		)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
		) ON [PRIMARY]
	</statement>
	
	<statement>
		DELETE FROM SYS_MODULES WHERE MODULE_ID = 'FRM_ADMIN_LINE_PRINT'
	</statement>

	<statement>
		DELETE FROM SYS_GROUP_PERMISSIONS WHERE MODULE_ID = 'FRM_ADMIN_LINE_PRINT'
	</statement>

	<statement>
		DELETE FROM SYS_MENUS WHERE MODULE_ID = 'FRM_ADMIN_LINE_PRINT'
	</statement>
	
	<statement>
		DELETE FROM SYS_TOOLBAR WHERE MODULE_ID = 'FRM_ADMIN_LINE_PRINT'
	</statement>
	

	<statement>
	ALTER VIEW [dbo].[view_auto_labeller_printer]
	AS
	SELECT      dbo.APP_AUTO_LABELLER.LINE, 
				dbo.APP_AUTO_LABELLER.MODIFIED, 
				dbo.APP_AUTO_LABELLER.UNIQUE_ID, 
	            dbo.APP_LABEL_DATA.LABEL_TYPE, 
				dbo.SYS_PRINTER_LINE_MEMBERSHIP.PRINTER_ID, 
	            dbo.SYS_PRINTERS.ENABLED, 
	            dbo.SYS_PRINTERS.PRINTER_TYPE, 
	            dbo.SYS_PRINTERS.IP_ADDRESS, 
	            dbo.SYS_PRINTERS.PORT, 
	            dbo.SYS_PRINTERS.GROUP_ID, 
	            dbo.SYS_PRINTERS.LANGUAGE, 
	            dbo.SYS_PRINTERS.PRINTER_DPI, 
	            dbo.APP_LABEL_DATA.PROCESS_ORDER, 
	            dbo.APP_LABEL_DATA.MATERIAL, 
	            dbo.APP_LABEL_DATA.MATERIAL_TYPE, 
	            dbo.APP_MATERIAL.DESCRIPTION AS MATERIAL_DESCRIPTION, 
	            dbo.APP_MATERIAL.SHELF_LIFE_UOM, 
	            dbo.APP_MATERIAL.SHELF_LIFE, 
	            dbo.APP_MATERIAL.SHELF_LIFE_RULE,           
	            dbo.APP_LABEL_DATA.BATCH_NUMBER, 
	            dbo.APP_LABEL_DATA.REQUIRED_RESOURCE, 
				(SELECT KEY_VALUE FROM SYS_CONTROL WHERE SYSTEM_KEY = 'PLANT') AS PLANT, 
	            dbo.APP_LABEL_DATA.LOCATION_ID, 
	            dbo.APP_LABEL_DATA.DATE_OF_MANUFACTURE, 
	            dbo.APP_LABEL_DATA.EXPIRY_DATE,
	            dbo.APP_LABEL_DATA.PROD_EAN, 
	            dbo.APP_LABEL_DATA.PROD_VARIANT, 
	            dbo.APP_LABEL_DATA.PROD_QUANTITY, 
	            dbo.APP_LABEL_DATA.PROD_UOM, 
	            dbo.APP_LABEL_DATA.BASE_EAN, 
	            dbo.APP_LABEL_DATA.BASE_VARIANT, 
	            dbo.APP_LABEL_DATA.BASE_QUANTITY, 
	            dbo.APP_LABEL_DATA.BASE_UOM, 
	            dbo.APP_LABEL_DATA.CUSTOMER_ID, 
	            dbo.APP_CUSTOMER.CUSTOMER_NAME,
	            dbo.APP_LABEL_DATA.PRINT_COPIES, 
	            dbo.APP_LABEL_DATA.MODULE_ID, 
	            dbo.APP_LABEL_DATA.OVERRIDE_MANUFACTURE_DATE, 
	            dbo.APP_LABEL_DATA.OVERRIDE_EXPIRY_DATE, 
	            dbo.APP_LABEL_DATA.OVERRIDE_BATCH_PREFIX, 
	            dbo.APP_LABEL_DATA.BATCH_PREFIX, 
	            dbo.APP_LABEL_DATA.BATCH_SUFFIX, 
	            dbo.SYS_MODULES.REPORT_TYPE,         
				dbo.SYS_MODULES.MODULE_TYPE,
	            dbo.SYS_MODULES.REPORT_FILENAME
	FROM        dbo.APP_AUTO_LABELLER 
				INNER JOIN dbo.SYS_PRINTER_LINE_MEMBERSHIP ON dbo.APP_AUTO_LABELLER.LINE = dbo.SYS_PRINTER_LINE_MEMBERSHIP.LINE AND dbo.APP_AUTO_LABELLER.GROUP_ID = dbo.SYS_PRINTER_LINE_MEMBERSHIP.GROUP_ID
				INNER JOIN dbo.SYS_PRINTERS ON dbo.SYS_PRINTER_LINE_MEMBERSHIP.PRINTER_ID = dbo.SYS_PRINTERS.PRINTER_ID AND dbo.SYS_PRINTER_LINE_MEMBERSHIP.GROUP_ID = dbo.SYS_PRINTERS.GROUP_ID
				INNER JOIN dbo.APP_LABEL_DATA ON dbo.APP_AUTO_LABELLER.UNIQUE_ID = dbo.APP_LABEL_DATA.UNIQUE_ID 
				INNER JOIN dbo.APP_MATERIAL ON dbo.APP_LABEL_DATA.MATERIAL = dbo.APP_MATERIAL.MATERIAL 
				INNER JOIN dbo.APP_CUSTOMER ON dbo.APP_LABEL_DATA.CUSTOMER_ID = dbo.APP_CUSTOMER.CUSTOMER_ID 
				INNER JOIN dbo.SYS_MODULES ON dbo.APP_LABEL_DATA.MODULE_ID = dbo.SYS_MODULES.MODULE_ID
	WHERE 		dbo.SYS_PRINTERS.ENABLED = 'Y'
	</statement>

	   	 
</DDL>
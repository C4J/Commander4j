<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE DDL SYSTEM "schema.dtd">
<DDL>
		
	<statement>	
		ALTER TABLE [dbo].[APP_PALLET_SAMPLES] ADD [LANE_1] numeric(22,3) DEFAULT 0.000
	</statement>
		
	<statement>	
		ALTER TABLE [dbo].[APP_PALLET_SAMPLES] ADD [LANE_2] numeric(22,3) DEFAULT 0.000
	</statement>
		
	<statement>	
		ALTER TABLE [dbo].[APP_PALLET_SAMPLES] ADD [LANE_3] numeric(22,3) DEFAULT 0.000
	</statement>
			
	<statement>	
		ALTER TABLE [dbo].[APP_PALLET_SAMPLES] ADD [LANE_4] numeric(22,3) DEFAULT 0.000
	</statement>
			
	<statement>	
		ALTER TABLE [dbo].[APP_PALLET_SAMPLES] ADD [LANE_5] numeric(22,3) DEFAULT 0.000
	</statement>
	
	<statement>          
			INSERT INTO SYS_LANGUAGE (RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Lane', 'EN', 'Lane', '0')
    </statement>   
    
    <statement>          
			INSERT INTO SYS_LANGUAGE (RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Lane', 'DE', 'Fahrspur', '0')
    </statement>   
    
    <statement>          
			INSERT INTO SYS_LANGUAGE (RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Lane', 'FR', 'Voie', '0')
    </statement>   
    
    <statement>          
			INSERT INTO SYS_LANGUAGE (RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Lane', 'NL', 'Rijstrook', '0')
    </statement>   
    
    <statement>          
			INSERT INTO SYS_LANGUAGE (RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Lane', 'ES', 'Carril', '0')
    </statement>   
    
    <statement>          
			INSERT INTO SYS_LANGUAGE (RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Lane', 'PL', 'Pas ruchu', '0')
    </statement>   
    
     <statement>          
			INSERT INTO SYS_LANGUAGE (RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Lane', 'HU', 'Vonal', '0')
    </statement>
    
     <statement>          
			INSERT INTO SYS_LANGUAGE (RESOURCE_KEY, LANGUAGE_ID, TEXT, MNEMONIC) VALUES ('lbl_Lane', 'IT', 'Sentiero', '0')
    </statement>   
    
    <statement>
    	    ALTER  VIEW view_pallet_samples AS   (	SELECT
			APP_PALLET_SAMPLES.SSCC AS SSCC,
			APP_PALLET_SAMPLES.SAMPLE_SEQUENCE AS SAMPLE_SEQUENCE,
			APP_PALLET_SAMPLES.SAMPLE_DATE AS SAMPLE_DATE,
			APP_PALLET_SAMPLES.SAMPLE_REASON AS SAMPLE_REASON,
			APP_PALLET_SAMPLES.DEFECT_TYPE AS DEFECT_TYPE,
			APP_PALLET_SAMPLES.DEFECT_ID AS DEFECT_ID,
			APP_PALLET_SAMPLES.LEAKING AS LEAKING,
			APP_PALLET_SAMPLES.SAMPLE_COMMENT AS SAMPLE_COMMENT,
			APP_PALLET_EXTENSION.PALLET_QUANTITY AS START_QUANTITY,
			APP_PALLET_SAMPLES.SAMPLE_QUANTITY AS SAMPLE_QUANTITY,
			APP_PALLET_SAMPLES.SAMPLE_POINT AS SAMPLE_POINT,
			APP_PALLET_SAMPLES.ID AS ID,
			APP_PALLET_SAMPLES.LANE_1 AS LANE_1,
			APP_PALLET_SAMPLES.LANE_2 AS LANE_2,
			APP_PALLET_SAMPLES.LANE_3 AS LANE_3,
			APP_PALLET_SAMPLES.LANE_4 AS LANE_4,
			APP_PALLET_SAMPLES.LANE_5 AS LANE_5,
			APP_PALLET_EXTENSION.FIRST_CASE_INPUT AS FIRST_CASE_INPUT,
			APP_PALLET_EXTENSION.FIRST_CASE_TIME AS FIRST_CASE_TIME,
			APP_PALLET_EXTENSION.LAST_CASE_INPUT AS LAST_CASE_INPUT,
			APP_PALLET_EXTENSION.LAST_CASE_TIME AS LAST_CASE_TIME,
			APP_PALLET_EXTENSION.SHIFT_ID AS SHIFT_ID,
			APP_PALLET_EXTENSION.SUPPLIER_ID1 AS SUPPLIER_ID1,
			APP_PALLET_EXTENSION.INCIDENT_REFERENCE AS INCIDENT_REFERENCE,
			APP_PALLET_EXTENSION.LOCATION AS LOCATION,
			APP_PALLET_EXTENSION.PRODUCT_GROUP AS PRODUCT_GROUP,
			APP_PALLET_EXTENSION.CONTAINER_CODE AS CONTAINER_CODE,
			APP_PALLET_EXTENSION.PWEEK AS PWEEK,
			APP_PALLET_EXTENSION.PDAY AS PDAY,
			APP_PALLET_EXTENSION.PMONTH AS PMONTH,
			APP_PALLET_EXTENSION.PYEAR AS PYEAR,
			APP_SUPPLIER.SUPPLIER_TYPE AS SUPPLIER_TYPE,
			APP_SUPPLIER.DESCRIPTION AS SUPPLIER_DESCRIPTION,
			APP_PALLET.LOCATION_ID AS LOCATION_ID,
			APP_PALLET.MATERIAL AS MATERIAL,
			APP_PALLET.BATCH_NUMBER AS BATCH_NUMBER,
			APP_PALLET.PROCESS_ORDER AS PROCESS_ORDER,
			APP_PALLET.DATE_OF_MANUFACTURE AS DATE_OF_MANUFACTURE,
			APP_PALLET.STATUS AS PALLET_STATUS,
			APP_PALLET.MHN_NUMBER AS MHN_NUMBER,
			APP_PALLET.DECISION AS DECISION,
			APP_SAMPLE_DEFECT_TYPE.DESCRIPTION AS DEFECT_TYPE_DESCRIPTION,
			APP_SAMPLE_DEFECT_TYPE.NON_LEAKING_DATA AS NON_LEAKING_DATA,
	    APP_SAMPLE_DEFECT_TYPE.LEAKING_DATA AS LEAKING_DATA,
			APP_SAMPLE_DEFECT_ID.DESCRIPTION AS DEFECT_ID_DESCRIPTION 
		FROM
			(((((
								APP_PALLET_SAMPLES
								LEFT JOIN APP_PALLET_EXTENSION ON ((
										APP_PALLET_SAMPLES.SSCC = APP_PALLET_EXTENSION.SSCC 
									)))
							LEFT JOIN APP_SUPPLIER ON ((
									APP_PALLET_EXTENSION.SUPPLIER_ID1 = APP_SUPPLIER.SUPPLIER_ID 
								)))
						LEFT JOIN APP_SAMPLE_DEFECT_ID ON ((
								APP_PALLET_SAMPLES.DEFECT_ID = APP_SAMPLE_DEFECT_ID.DEFECT_ID 
							)))
					LEFT JOIN APP_SAMPLE_DEFECT_TYPE ON ((
							APP_PALLET_SAMPLES.DEFECT_TYPE = APP_SAMPLE_DEFECT_TYPE.DEFECT_TYPE 
						)))
				LEFT JOIN APP_PALLET ON ((
					APP_PALLET_SAMPLES.SSCC = APP_PALLET.SSCC 
			))))
    </statement>
    
    <statement>
   			ALTER VIEW [dbo].[view_sorting_data] AS (SELECT
				APP_PALLET_EXTENSION.SSCC AS SSCC,
				APP_PALLET_EXTENSION.SHIFT_ID AS SHIFT_ID,
				APP_PALLET_EXTENSION.SUPPLIER_ID1 AS SUPPLIER_ID1,
				APP_PALLET_EXTENSION.INCIDENT_REFERENCE AS INCIDENT_REFERENCE,
				APP_PALLET_EXTENSION.FIRST_CASE_TIME AS FIRST_CASE_TIME,
				APP_PALLET_EXTENSION.LAST_CASE_TIME AS LAST_CASE_TIME,
				APP_PALLET.LOCATION_ID AS LOCATION_ID,
				APP_PALLET.BATCH_NUMBER AS BATCH_NUMBER,
				APP_PALLET.MHN_NUMBER AS MHN_NUMBER,
				APP_PALLET.DESPATCH_NO AS DESPATCH_NO,
				APP_PALLET_EXTENSION.LOCATION AS LOCATION,
				APP_PALLET_EXTENSION.PRODUCT_GROUP AS PRODUCT_GROUP,
				APP_PALLET_EXTENSION.CONTAINER_CODE AS CONTAINER_CODE,
				APP_PALLET_EXTENSION.PALLET_QUANTITY AS PALLET_QUANTITY,
				APP_PALLET_SAMPLES.SAMPLE_DATE AS SAMPLE_DATE,
				APP_PALLET_SAMPLES.SAMPLE_REASON AS SAMPLE_REASON,
				APP_PALLET_SAMPLES.DEFECT_TYPE AS DEFECT_TYPE,
				APP_PALLET_SAMPLES.DEFECT_ID AS DEFECT_ID,
				APP_PALLET_SAMPLES.LEAKING AS LEAKING,
				APP_PALLET_SAMPLES.SAMPLE_COMMENT AS SAMPLE_COMMENT,
				APP_PALLET_SAMPLES.SAMPLE_QUANTITY AS SAMPLE_QUANTITY,
				APP_PALLET_SAMPLES.SAMPLE_POINT AS SAMPLE_POINT,
				APP_PALLET_SAMPLES.ID AS ID,
				APP_PALLET_SAMPLES.LANE_1 AS LANE_1,
				APP_PALLET_SAMPLES.LANE_2 AS LANE_2,
				APP_PALLET_SAMPLES.LANE_3 AS LANE_3,
				APP_PALLET_SAMPLES.LANE_4 AS LANE_4,
				APP_PALLET_SAMPLES.LANE_5 AS LANE_5,
				APP_PALLET.MATERIAL AS MATERIAL,
				APP_MATERIAL.DESCRIPTION AS MATERIAL_DESCRIPTION,
				APP_PALLET.QUANTITY AS QUANTITY,
				APP_PALLET.UOM AS UOM,
				APP_PALLET.DATE_OF_MANUFACTURE AS DATE_OF_MANUFACTURE,
				APP_PALLET.STATUS AS STATUS,
				APP_MATERIAL_BATCH.STATUS AS BATCH_STATUS,
				APP_SAMPLE_DEFECT_TYPE.DESCRIPTION AS DEFECT_DESCRIPTION,
				APP_SAMPLE_DEFECT_ID.LONG_DESCRIPTION AS LONG_DESCRIPTION,
				APP_SAMPLE_REASONS.DESCRIPTION AS REASON_DESCRIPTION 
			FROM
				APP_PALLET_SAMPLES
				LEFT JOIN APP_SAMPLE_DEFECT_ID ON ( APP_PALLET_SAMPLES.DEFECT_ID = APP_SAMPLE_DEFECT_ID.DEFECT_ID )
				LEFT JOIN APP_SAMPLE_DEFECT_TYPE ON ( APP_PALLET_SAMPLES.DEFECT_TYPE = APP_SAMPLE_DEFECT_TYPE.DEFECT_TYPE )
				LEFT JOIN APP_SAMPLE_REASONS ON ( APP_PALLET_SAMPLES.SAMPLE_REASON = APP_SAMPLE_REASONS.SAMPLE_REASON )
				LEFT JOIN APP_PALLET_EXTENSION ON ( APP_PALLET_EXTENSION.SSCC = APP_PALLET_SAMPLES.SSCC )
				LEFT JOIN APP_PALLET ON ( APP_PALLET_EXTENSION.SSCC = APP_PALLET.SSCC )
				LEFT JOIN APP_MATERIAL_BATCH ON ( APP_PALLET.MATERIAL = APP_MATERIAL_BATCH.MATERIAL ) 
				AND ( APP_PALLET.BATCH_NUMBER = APP_MATERIAL_BATCH.BATCH_NUMBER )
				LEFT JOIN APP_MATERIAL ON (APP_PALLET.MATERIAL = APP_MATERIAL.MATERIAL)) 
    </statement>
    
    <statement>
    	CREATE SYNONYM APE FOR dbo.APP_PALLET_EXTENSION  
    </statement>
    
    <statement>
		CREATE SYNONYM APS FOR dbo.APP_PALLET_SAMPLES
    </statement>
    
    <statement>
		CREATE SYNONYM AP FOR dbo.APP_PALLET 
    </statement>
    
    <statement>
		CREATE SYNONYM APH FOR dbo.APP_PALLET_HISTORY  
    </statement>  
    
    <statement>
   	 ALTER TABLE [dbo].[SYS_USER_REPORTS] ALTER COLUMN [SQL_SELECT] varchar(8000) COLLATE SQL_Latin1_General_CP1_CI_AS NULL
    </statement>
      
    <statement>
INSERT INTO [dbo].[SYS_USER_REPORTS] (
[USER_REPORT_ID], 
[DISPLAY_SEQUENCE], 
[DESCRIPTION], 
[SQL_SELECT], 
[MODULE_ID], 
[DESTINATION], 
[ENABLED], 
[PRIVATE], 
[USER_ID], 
[GROUP_ID], 
[PARAM_DATE_RANGE], 
[SAVE_PATH], 
[PREVIEW], 
[PROMPT_SAVE_AS], 
[EMAIL_ENABLED], 
[EMAIL_PROMPT_ENABLED], 
[EMAIL_ADDRESSES]) 
VALUES ('SORTING_7', 
0, 
'Export Pallet Sorting Results Data','SELECT
 APS.SSCC AS ''Pallet Number'',
 MAX(APE.PWEEK) AS ''Week'',
 MAX(AP.DATE_OF_MANUFACTURE) AS ''Date of Production'',
 MAX(AP.MATERIAL) AS ''Product Code'',
 MAX(APE.FIRST_CASE_TIME) AS ''Sample Time Youngest'',
 MAX(APE.LAST_CASE_TIME) AS ''Sample Time Oldest'',
 0 as ''No Box Sorted'',
 0 as ''No Per Box'',
 SUM(APH.QUANTITY) AS ''No Tested'',
 MAX(APE.CONTAINER_CODE) AS ''Product Format Code'',
 MAX(APE.PRODUCT_GROUP) AS ''Product Type'',
APS.SAMPLE_POINT AS ''Volpak Number'',
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.DEFECT_ID IN (''BSF-02'') AND X.LEAKING = ''Y'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Leaking Bottom(SEal'',
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.DEFECT_ID IN (''SSF-01'',''SSF-02'') AND X.LEAKING = ''Y'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Leaking Side(SEal'',
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.DEFECT_ID IN (''TSF-01'',''TSF-02'',''TSF-03'',''TSF-04'',''TSF-06'',''TSF-07'',''TSF-08'',''TSF-09'') AND X.LEAKING = ''Y'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Leaking Top(SEal'',
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.DEFECT_ID IN (''SWO-01'') AND X.LEAKING = ''Y'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Swollen with Leak'', 
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.DEFECT_ID IN (''SWO-01'') AND X.LEAKING = ''N'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Swollen without Leak'', 
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.DEFECT_ID IN (''PUN-01'') AND X.LEAKING = ''Y'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Leaking Punctures'',
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.DEFECT_ID IN (''CUT-01'') AND X.LEAKING = ''Y'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Leaking Cut'',
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.DEFECT_ID IN (''BSF-01'') AND X.LEAKING = ''Y'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Leaking Triple Point'',  
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE (X.DEFECT_ID IN (''BSF-02'',''SSF-01'',''SSF-02'',''TSF-01'',''TSF-02'',''TSF-03'',''TSF-04'',''TSF-06'',''TSF-07'',''TSF-08'',''TSF-09'',''SWO-01'',''PUN-01'',''CUT-01'',''BSF-01'') AND X.LEAKING = ''Y'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) OR (X.DEFECT_ID IN (''SWO-01'') AND X.LEAKING = ''N'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE))  AS ''Total Critical Defects (Leaking)'',
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.DEFECT_ID IN (''BSF-02'') AND X.LEAKING = ''N'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Non Leaking Bottom(SEal'',
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.DEFECT_ID IN (''SSF-01'',''SSF-02'') AND X.LEAKING = ''N'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Non Leaking Side(SEal'', 
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.DEFECT_ID IN (''TSF-02'',''TSF-09'') AND X.LEAKING = ''N'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Non Leaking Top(SEal Creased'',
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.DEFECT_ID IN (''TSF-07'') AND X.LEAKING = ''N'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Non-Leaking Top(SEaling Folded Corner'',
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.DEFECT_ID IN (''TSF-06'') AND X.LEAKING = ''N'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Non-Leaking Top(SEaling OverLap'',
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.DEFECT_ID IN (''TSF-03'') AND X.LEAKING = ''N'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Non-Leaking Top(SEaling UltraSonic Miss-align'',
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.DEFECT_ID IN (''TSF-08'') AND X.LEAKING = ''N'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Non-Leaking Aluminium Visible'',
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE (X.DEFECT_ID IN (''BSF-02'',''SSF-01'',''SSF-02'',''TSF-02'',''TSF-09'',''TSF-07'',''TSF-06'',''TSF-03'',''TSF-08'') AND X.LEAKING = ''N''  AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) ) AS ''Non-Leaking Total'',
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE (X.DEFECT_ID IN (''BSF-02'',''SSF-01'',''SSF-02'',''TSF-01'',''TSF-02'',''TSF-03'',''TSF-04'',''TSF-06'',''TSF-07'',''TSF-08'',''TSF-09'',''SWO-01'',''PUN-01'',''CUT-01'',''BSF-01'') AND X.LEAKING = ''Y'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) OR (X.DEFECT_ID IN (''SWO-01'') AND X.LEAKING = ''N'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) OR (X.DEFECT_ID IN (''BSF-02'',''SSF-01'',''TSF-02'',''TSF-09'',''TSF-07'',''TSF-06'',''TSF-03'',''TSF-08'') AND X.LEAKING = ''N'' AND X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) )  AS ''Total Critical &amp; Non Leak'',
(SELECT CAST(ISNULL(SUM(SAMPLE_QUANTITY),0) AS INT) FROM APS X WHERE X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Total No of Defects'',
(SELECT CAST(ISNULL(SUM(LANE_1),0) AS INT) FROM APS X WHERE X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Lane 1'', 
(SELECT CAST(ISNULL(SUM(LANE_2),0) AS INT) FROM APS X WHERE X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Lane 2'',
(SELECT CAST(ISNULL(SUM(LANE_3),0) AS INT) FROM APS X WHERE X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Lane 3'',
(SELECT CAST(ISNULL(SUM(LANE_4),0) AS INT) FROM APS X WHERE X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Lane 4'',
(SELECT CAST(ISNULL(SUM(LANE_5),0) AS INT) FROM APS X WHERE X.SSCC = APS.SSCC AND X.SAMPLE_SEQUENCE = APS.SAMPLE_SEQUENCE) AS ''Lane 5'',
MAX(APE.SUPPLIER_ID1) AS ''Laminate Supplier'',
MAX(APE.PMONTH) AS ''Month'',
MAX(APE.SHIFT_ID) AS ''Shift'',
MAX(APE.PYEAR) AS ''Year'',
APS.SAMPLE_REASON AS ''Sort Reason'',
APS.DEFECT_TYPE AS ''Sort Type'',
APS.DEFECT_ID AS ''Sort Defect'',
APS.LEAKING AS ''Leaking'',
MAX(APE.LOCATION) AS ''Location'',
MAX(AP.MHN_NUMBER) AS ''MHN Number''
FROM
dbo.APS 
LEFT JOIN dbo.APE ON APS.SSCC = APE.SSCC
LEFT JOIN dbo.AP ON APS.SSCC = AP.SSCC 
LEFT JOIN dbo.APH ON APS.SSCC = APH.SSCC AND APH.TRANSACTION_TYPE = ''PROD DEC'' AND APH.TRANSACTION_SUBTYPE = ''CONFIRM''
WHERE SAMPLE_DATE &gt;= ? AND SAMPLE_DATE &lt;= ?
GROUP BY
APS.SAMPLE_REASON,
APS.SSCC,
APS.SAMPLE_SEQUENCE,
APS.SAMPLE_POINT,
APS.SAMPLE_DATE,
APS.DEFECT_TYPE,
APS.DEFECT_ID,
APS.LEAKING', 
'','EXCEL','Y','N','FRED','','Y','','Y','Y','N','N','');
	</statement>
	
</DDL>
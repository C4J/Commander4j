<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE DDL SYSTEM "schema.dtd">
<DDL>

	<statement>
		DROP VIEW view_pallet_expiry
	</statement>
	
	<statement>
		CREATE OR REPLACE VIEW view_pallet_expiry AS ( SELECT
		P."SSCC",
		P."LOCATION_ID",
		P."MATERIAL",
		P."BATCH_NUMBER",
		P."PROCESS_ORDER",
		P."QUANTITY",
		P."UOM",
		P."DATE_OF_MANUFACTURE",
		P."STATUS",
		P."EAN",
		P."VARIANT",
		P."DESPATCH_NO",
		P."CONFIRMED",
		P."LAYERS",
		P."SSCC_EXPIRY_DATE",
		P."CUSTOMER_ID",
		P."MHN_NUMBER",
		P."DECISION",
		B.EXPIRY_DATE,
		M.DESCRIPTION,
		M.OLD_MATERIAL,
		C.CUSTOMER_NAME,
		C.PRINT_ON_LABEL,
		p.DATE_CREATED,
		P.CREATED_BY_USER_ID,
		P.DATE_UPDATED,
		P.UPDATED_BY_USER_ID,
		M.GROSS_WEIGHT,
		M.NET_WEIGHT,
		M.WEIGHT_UOM,
		D.DATA AS PART_NO,
		E.DATA AS CASE_CONTENT,
		O.REQUIRED_RESOURCE AS REQUIRED_RESOURCE
		FROM
			APP_PALLET P
			LEFT JOIN APP_MATERIAL_BATCH B ON ( P.MATERIAL = B.MATERIAL AND P.BATCH_NUMBER = B.BATCH_NUMBER )
			LEFT JOIN APP_MATERIAL M ON P.MATERIAL = M.MATERIAL
			LEFT JOIN APP_CUSTOMER C ON P.CUSTOMER_ID = C.CUSTOMER_ID
			LEFT JOIN APP_PROCESS_ORDER O ON P.PROCESS_ORDER = O.PROCESS_ORDER
			LEFT JOIN APP_MATERIAL_CUSTOMER_DATA D ON ( D.MATERIAL = P.MATERIAL AND D.CUSTOMER_ID = P.CUSTOMER_ID AND D.DATA_ID = 'PART_NO' )
		LEFT JOIN APP_MATERIAL_CUSTOMER_DATA E ON ( E.MATERIAL = P.MATERIAL AND E.CUSTOMER_ID = P.CUSTOMER_ID AND E.DATA_ID = 'CASE_CONTENT' ) 
		)
	</statement>

</DDL>
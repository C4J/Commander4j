<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE DDL SYSTEM "schema.dtd">
<DDL>

<statement>
	ALTER TABLE `APP_PALLET_HISTORY` ADD INDEX `PH_SSCC_NDX` (`SSCC` ASC, `TRANSACTION_DATE` ASC) ;
</statement>

<statement>
	ALTER TABLE APP_PALLET ADD COLUMN `DATE_CREATED` DATETIME NULL DEFAULT NULL  AFTER `DECISION`;
</statement>

<statement>
	ALTER TABLE `APP_PALLET` ADD COLUMN `CREATED_BY_USER_ID` VARCHAR(20) NULL DEFAULT NULL  AFTER `DATE_CREATED` ;
</statement>

<statement>
	ALTER TABLE APP_PALLET ADD COLUMN `DATE_UPDATED` DATETIME NULL DEFAULT NULL  AFTER `CREATED_BY_USER_ID`;
</statement>

<statement>
	ALTER TABLE `APP_PALLET` ADD COLUMN `UPDATED_BY_USER_ID` VARCHAR(20) NULL DEFAULT NULL  AFTER `DATE_UPDATED` ;
</statement>

<statement>
	UPDATE APP_PALLET AS T1 SET DATE_CREATED = (SELECT MIN(TRANSACTION_DATE) FROM APP_PALLET_HISTORY T2 WHERE T2.SSCC = T1.SSCC);
</statement>

<statement>
	UPDATE APP_PALLET AS T1 SET DATE_UPDATED = (SELECT MAX(TRANSACTION_DATE) FROM APP_PALLET_HISTORY T2 WHERE T2.SSCC = T1.SSCC);
</statement>

<statement>
	UPDATE APP_PALLET AS T1 SET CREATED_BY_USER_ID = 
	(SELECT USER_ID FROM APP_PALLET_HISTORY T2 
	WHERE T2.SSCC = T1.SSCC AND TRANSACTION_REF = 
	(SELECT MIN(TRANSACTION_REF) 
	FROM APP_PALLET_HISTORY T2 WHERE T2.SSCC = T1.SSCC) LIMIT 1);
</statement>

<statement>
	UPDATE APP_PALLET AS T1 SET UPDATED_BY_USER_ID = 
	(SELECT USER_ID FROM APP_PALLET_HISTORY T2 
	WHERE T2.SSCC = T1.SSCC AND TRANSACTION_REF = 
	(SELECT MAX(TRANSACTION_REF) 
	FROM APP_PALLET_HISTORY T2 WHERE T2.SSCC = T1.SSCC) LIMIT 1);
</statement>


<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Created_By', 'EN', 'Date Created', 'Q')
</statement>

<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Created_By', 'NL', 'Gemaakt door', 'Q')
</statement>

<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Created_By', 'HU', 'Létrehozta', 'Q')
</statement>

<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Created_By', 'IT', 'Creato da', 'Q')
</statement>

<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Date_Created', 'EN', 'Created By', 'Q')
</statement>

<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Date_Created', 'NL', 'Aanmaakdatum', 'Q')
</statement>

<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Date_Created', 'HU', 'Létrehozás dátuma', 'Q')
</statement>

<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Date_Created', 'IT', 'Data di creazione', 'Q')
</statement>

<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Updated_By', 'EN', 'Updated By', 'Q')
</statement>

<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Updated_By', 'NL', 'bijgewerkt door', 'Q')
</statement>

<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Updated_By', 'HU', 'Módosította', 'Q')
</statement>

<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Updated_By', 'IT', 'Aggiornato da', 'Q')
</statement>

<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Date_Updated', 'EN', 'Date Updated', 'Q')
</statement>

<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Date_Updated', 'NL', 'Datum bijgewerkt', 'Q')
</statement>

<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Date_Updated', 'HU', 'Frissítés dátuma', 'Q')
</statement>

<statement>
INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Date_Updated', 'IT', 'Data aggiornamento', 'Q')
</statement>

<statement>
ALTER VIEW `view_pallet_expiry` AS select 
`p`.`SSCC` AS `SSCC`,
`p`.`LOCATION_ID` AS `LOCATION_ID`,
`p`.`MATERIAL` AS `MATERIAL`,
`p`.`BATCH_NUMBER` AS `BATCH_NUMBER`,
`p`.`PROCESS_ORDER` AS `PROCESS_ORDER`,
`p`.`QUANTITY` AS `QUANTITY`,
`p`.`UOM` AS `UOM`,
`p`.`DATE_OF_MANUFACTURE` AS `DATE_OF_MANUFACTURE`,
`p`.`STATUS` AS `STATUS`,
`p`.`EAN` AS `EAN`,
`p`.`VARIANT` AS `VARIANT`,
`p`.`DESPATCH_NO` AS `DESPATCH_NO`,
`p`.`CONFIRMED` AS `CONFIRMED`,
`p`.`LAYERS` AS `LAYERS`,
`p`.`SSCC_EXPIRY_DATE` AS `SSCC_EXPIRY_DATE`,
`p`.`CUSTOMER_ID` AS `CUSTOMER_ID`,
`p`.`MHN_NUMBER` AS `MHN_NUMBER`,
`p`.`DECISION` AS `DECISION`,
`b`.`EXPIRY_DATE` AS `EXPIRY_DATE`,
`m`.`DESCRIPTION` AS `DESCRIPTION`,
`m`.`OLD_MATERIAL` AS `OLD_MATERIAL`,
`c`.`CUSTOMER_NAME` AS `CUSTOMER_NAME`,
`c`.`PRINT_ON_LABEL` AS `PRINT_ON_LABEL`, 
`p`.`DATE_CREATED` AS `DATE_CREATED`,
`p`.`CREATED_BY_USER_ID` AS `CREATED_BY_USER_ID`,
`p`.`DATE_UPDATED` AS `DATE_UPDATED`,
`p`.`UPDATED_BY_USER_ID` AS `UPDATED_BY_USER_ID`
from (((`APP_PALLET` `p` join `APP_MATERIAL_BATCH` `b`) 
join `APP_MATERIAL` `m`) join `APP_CUSTOMER` `c`) 
where ((`b`.`MATERIAL` = `p`.`MATERIAL`) 
and (`b`.`BATCH_NUMBER` = `p`.`BATCH_NUMBER`) 
and (`m`.`MATERIAL` = `p`.`MATERIAL`) 
and (`c`.`CUSTOMER_ID` = `p`.`CUSTOMER_ID`))
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Deleted', 'EN', 'Deleted', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Deleted', 'NL', 'Verwijderde', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Deleted', 'HU', 'Törölt', 'Q')
</statement>

<statement>
	INSERT INTO SYS_LANGUAGE (RESOURCE_KEY,LANGUAGE_ID,TEXT,MNEMONIC) VALUES ('lbl_Deleted', 'IT', 'Soppresso', 'Q')
</statement>

<statement>
INSERT INTO SYS_MODULES (MODULE_ID,RF_ACTIVE,DK_ACTIVE,MODULE_TYPE,HINT,MNEMONIC,ICON_FILENAME,HELPSET_ID,REPORT_FILENAME,EXEC_FILENAME,EXEC_DIR,PRINT_PREVIEW,PRINT_DIALOG,PRINT_COPIES,REPORT_TYPE,RESOURCE_KEY) VALUES
('FRM_PAL_DELETE', 'Y', 'N', 'FORM', 'Delete Pallet', '77', 'split.gif', '', '', '', '', 'Y', 'N', '1', '', 'mod_FRM_ADMIN_PALLET_DELETE')
</statement>

<statement>
INSERT INTO SYS_RF_MENU (MODULE_ID,SEQUENCE_ID) VALUES ('FRM_PAL_DELETE','3')
</statement>

<statement>
INSERT INTO SYS_GROUP_PERMISSIONS (GROUP_ID,MODULE_ID) VALUES ('ADMIN', 'FRM_PAL_DELETE')
</statement>

<statement>
	ALTER TABLE `APP_LOCATION` ADD COLUMN `MSG_PALLET_DELETE` VARCHAR(1) DEFAULT 'N';
</statement>

</DDL>